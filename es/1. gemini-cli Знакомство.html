<h2>Gemini CLI: Introducci贸n y primeros pasos.</h2>
<p><strong>Gemini CLI</strong> es una herramienta que funciona directamente en tu terminal, comprende tu base de c贸digo y ayuda a corregir errores mediante consultas en lenguaje natural. Es la respuesta de Google a Claude Code de Anthropic.
Puedes usar Gemini 2.5 Pro (la herramienta cambiar谩 a Gemini 2.5 Flash si se alcanza el l铆mite) y su ventana de contexto de 1 mill贸n de tokens para realizar hasta 60 solicitudes por minuto y 1000 solicitudes por d铆a, todo de forma gratuita.</p>
<h3>Contenido</h3>
<ul>
<li>Comprensi贸n y navegaci贸n por grandes bases de c贸digo</li>
<li>Detecci贸n y correcci贸n de errores</li>
<li>Escritura y prueba de c贸digo</li>
<li>Herramientas de Gemini CLI</li>
<li>Integraci贸n de Google CLI con MCP</li>
</ul>
<h3>Caracter铆sticas clave de Gemini CLI:</h3>
<ul>
<li><strong>Edici贸n y refactorizaci贸n:</strong> Mejora y simplifica autom谩ticamente tu c贸digo bajo la gu铆a de la IA.</li>
<li><strong>Detecci贸n y correcci贸n de errores:</strong> Encuentra errores y sugiere soluciones.</li>
<li><strong>Comprensi贸n del c贸digo:</strong> Gemini CLI puede resumir la arquitectura, explicar los roles de los m贸dulos o construir mapas de flujo de ejecuci贸n.</li>
<li><strong>Generaci贸n de pruebas:</strong> Crea autom谩ticamente casos de prueba para <code>pytest</code></li>
<li><strong>Soporte de documentaci贸n:</strong> Puedes crear documentos markdown estructurados, registros de cambios (changelogs) y responder a problemas de GitHub directamente en la terminal.</li>
<li><strong>Ejecuci贸n de comandos:</strong> Gemini CLI puede ejecutar comandos de shell como <code>git</code>, <code>npm</code>, <code>pip</code> y otros, lo que te permite administrar proyectos sin salir de la CLI.</li>
</ul>
<hr>
<h3>Paso 1: Requisitos previos</h3>
<p>Para empezar, instala Node.js (versi贸n 18 o superior). Puedes descargar el instalador de tu elecci贸n o ejecutar los siguientes comandos bash en tu terminal:</p>
<pre class="line-numbers"><code class="language-bash"># Descargar e instalar nvm (Node Version Manager):
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.3/install.sh | bash

# Inicializar nvm en la sesi贸n actual de la terminal
. "$HOME/.nvm/nvm.sh"

# Descargar e instalar Node.js (por ejemplo, versi贸n 22):
nvm install 22

# Comprobar la versi贸n de Node.js:
node -v # Deber铆a mostrar "v22.17.0" o similar

# Comprobar la versi贸n de npm:
npm -v # Deber铆a mostrar "10.9.2" o similar
</code></pre>
<blockquote>
<p>锔 <strong>Importante para usuarios de Windows:</strong>
El comando <code>nvm</code> anterior es para <strong>Linux/macOS</strong> y <strong>no funcionar谩 en PowerShell o cmd.exe</strong>.
Para Windows, usa <a href="https://github.com/coreybutler/nvm-windows">nvm-windows</a>, descargando <code>nvm-setup.exe</code> de la secci贸n <a href="https://github.com/coreybutler/nvm-windows/releases">Releases</a>.
Alternativamente, puedes instalar WSL (Windows Subsystem for Linux) y ejecutar los comandos en Ubuntu o otra distribuci贸n de Linux.</p>
</blockquote>
<hr>
<h3>Paso 2: Configuraci贸n de Gemini CLI</h3>
<h4>Paso 2.1: Instalaci贸n de Gemini CLI</h4>
<p>Una vez que Node.js y npm est茅n instalados y verificados, instala Gemini CLI ejecutando el siguiente comando en tu terminal:</p>
<pre class="line-numbers"><code class="language-bash">npx https://github.com/google-gemini/gemini-cli
</code></pre>
<p>O usa <code>npm</code> para la instalaci贸n global:</p>
<pre class="line-numbers"><code class="language-bash">npm install -g @google/gemini-cli
gemini
</code></pre>
<p>Despu茅s de la instalaci贸n, escribe <code>gemini</code> en tu terminal para acceder a la herramienta.</p>
<h4>Paso 2.2: Autenticaci贸n</h4>
<p>Puedes usar tu cuenta personal de Google para la autenticaci贸n. Esto te dar谩 hasta 60 solicitudes por minuto y 1000 solicitudes por d铆a al usar Gemini.
<p><img src="assets/gemini_cli_1/auth.png" alt="First Run"></p>
<p>En esta gu铆a, utilic茅 <strong>Iniciar sesi贸n con Google</strong>, pero tambi茅n puedes usar una <strong>clave API</strong> (establecida como variable de entorno o en un archivo <code>.env</code>) o la autenticaci贸n de <strong>Vertex AI</strong>.</p>
<p>Para generar una nueva clave API, inicia sesi贸n en <strong>AI Studio</strong> con tu cuenta de Google y haz clic en "Crear clave API".</p>
<pre class="line-numbers"><code class="language-bash"># Establecer clave como variable de entorno
export GEMINI_API_KEY="Your_API_Key"

# O crear un archivo .env
GEMINI_API_KEY="Your_API_Key"
</code></pre>
<p>Puedes usar el comando <code>/auth</code> en el campo de texto para cambiar los m茅todos de autenticaci贸n seg煤n sea necesario.</p>
<hr>
<h3>Paso 3: Configuraci贸n de un proyecto en Gemini CLI</h3>
<p><img src="assets/gemini_cli_1/start.png" alt="Start"></p>
<p>Una vez que la CLI est茅 en funcionamiento, podemos comenzar a interactuar con Gemini desde la terminal. Hay dos formas de trabajar con un proyecto.</p>
<h4>1. Iniciar un nuevo proyecto</h4>
<p>Para iniciar un proyecto desde cero, ejecuta los siguientes comandos:</p>
<pre class="line-numbers"><code class="language-bash">cd new-project/
gemini
</code></pre>
<p>Dentro de la CLI, usa un prompt para resolver el problema que te interese, por ejemplo:
<blockquote>
<p>Escribe el c贸digo del codificador para un transformador desde cero.</p>
</blockquote>
<p><img src="assets/gemini_cli_1/example_1.png" alt="Example 1"></p>
<p>Concede permiso para escribir archivos:</p>
<p><img src="assets/gemini_cli/file.png" alt="File"></p>
<h4>2. Trabajar con un proyecto existente</h4>
<p>Si ya tienes una base de c贸digo, puedes trabajar con ella ejecutando los siguientes comandos:</p>
<pre class="line-numbers"><code class="language-bash">git clone https://github.com/AashiDutt/Google-Agent-Development-Kit-Demo
cd Google-Agent-Development-Kit-Demo
gemini
</code></pre>
<p>Dentro de la CLI, usa un prompt, por ejemplo:
<blockquote>
<p>Proporci贸name un resumen de todos los cambios realizados en la base de c贸digo en el 煤ltimo mes.</p>
</blockquote>
<hr>
<h3>Paso 4: Experimentando con Gemini CLI</h3>
<p>Como ejemplo, usar茅 el proyecto <strong><a href="https://github.com/AashiDutt/Google-Agent-Development-Kit-Demo">ADK-based Travel Planner </a></strong>.
Con Gemini CLI, mostrar茅 c贸mo:</p>
<ol>
<li>explorar la base de c贸digo</li>
<li>detectar un error o problema en GitHub o en un archivo</li>
<li>refactorizar c贸digo y generar pruebas unitarias</li>
<li>crear un informe markdown de los cambios realizados</li>
<li>visualizar la base de c贸digo generando un diagrama de flujo</li>
</ol>
<h4>Explorando y comprendiendo la base de c贸digo</h4>
<p>Comencemos pidi茅ndole a Gemini que explore y explique la base de c贸digo.</p>
<p><strong>Prompt:</strong> <code>Explora el directorio actual y describe la arquitectura del proyecto.</code></p>
<p>Gemini CLI devolver谩 un resumen estructurado que explica la arquitectura:</p>
<ul>
<li><strong>Interfaz de usuario:</strong> Una aplicaci贸n Streamlit (<code>travel_ui.py</code>) proporciona una interfaz para la interacci贸n.</li>
<li><strong>Orquestaci贸n:</strong> <code>host_agent</code> act煤a como coordinador central.</li>
<li><strong>Agentes especializados:</strong> <code>flight_agent</code>, <code>stay_agent</code>, <code>activities_agent</code> para buscar vuelos, hoteles y actividades.</li>
<li><strong>Comunicaci贸n:</strong> Los agentes se comunican entre s铆 a trav茅s de una API RESTful de FastAPI.</li>
<li><strong>Componentes compartidos:</strong> <code>shared/schemas.py</code> define estructuras de datos comunes.</li>
</ul>
<p>Esto te ayudar谩 a navegar sin leer cada archivo manualmente.</p>
<h4>Analizando y corrigiendo un problema de GitHub</h4>
<p>Exploremos algunos problemas abiertos del repositorio de GitHub.</p>
<p><strong>Prompt:</strong> <code>Aqu铆 hay un problema de GitHub: [@search https://github.com/AashiDutt/Google-Agent-Development-Kit-Demo/issues/1]. Analiza la base de c贸digo y prop贸n un plan de soluci贸n de 3 pasos. 驴Qu茅 archivos/funciones deben cambiarse?</code></p>
<p>Gemini CLI investig贸 el problema:</p>
<ul>
<li>Usando la funci贸n <code>@search</code>, recuper贸 datos de GitHub.</li>
<li>Identific贸 la causa ra铆z como un error de serializaci贸n JSON (en este caso, la funci贸n as铆ncrona <code>create_session()</code> no se llam贸 con <code>await</code>).</li>
<li>Sugiri贸 cambios y manejo de respuestas en varios archivos.</li>
</ul>
<p>A continuaci贸n, la CLI espera la entrada del usuario para evaluar los cambios. Si el usuario est谩 de acuerdo, aplicar谩 los cambios sugeridos.</p>
<h4>Implementando y probando la soluci贸n</h4>
<p>Ahora implementemos y probemos las soluciones sugeridas por Gemini.</p>
<p><strong>Prompt:</strong> <code>Escribe una prueba unitaria para este cambio en pytest en el archivo test_shared.py.</code></p>
<p>Gemini CLI:</p>
<ul>
<li>Insert贸 <code>json.dumps()</code> antes de enviar la carga 煤til de la tarea.</li>
<li>Cre贸 <code>test_agents.py</code> para agregar pruebas unitarias.</li>
<li>Agreg贸 un nuevo caso de prueba para verificar el esquema y pasar mensajes de agente anidados.</li>
</ul>
<h4>Generando documentaci贸n</h4>
<p>Ahora que se han aplicado las correcciones, resumamos los cambios y escrib谩moslos en Markdown en un <code>.txt</code> file.</p>
<p><strong>Prompt:</strong> <code>Escribe un resumen en markdown del error, la correcci贸n y la cobertura de la prueba. Formatea como una entrada de registro de cambios bajo la versi贸n "v0.2.0".</code></p>
<p>Then, to save the summary to a document, I used the following prompt:</p>
<p><strong>Prompt:</strong> <code>Guarda este resumen en un archivo .txt y n贸mbralo summary.txt</code></p>
<p>Gemini CLI uses the <code>WriteFile</code> tool to save the <code>summary.txt</code> file in the project directory.</p>
<h4>Generando un diagrama de flujo usando MCP</h4>
<p>Esta secci贸n ampl铆a experimentos anteriores donde exploro c贸mo Gemini CLI utiliza el <strong>Protocolo de Contexto del Modelo (MCP)</strong> para mantener res煤menes a nivel de archivo e historial de tareas entre prompts. Esto le da a Gemini "memoria de trabajo" dentro de una sesi贸n.</p>
<p><strong>Prompt:</strong> <code>Genera un diagrama de flujo que muestre c贸mo los agentes se comunican a trav茅s de A2A (agente a agente) y c贸mo main.py gestiona el sistema. Resalta d贸nde ocurri贸 el problema y c贸mo se solucion贸.</code></p>
<p>Esta visualizaci贸n fue posible gracias a la memoria persistente de Gemini, que retuvo el contexto completo de nuestra correcci贸n de errores anterior y la estructura del agente sin necesidad de recargar archivos.</p>
<h3>Herramientas disponibles de Gemini CLI</h3>
<p>Al llamar al comando <code>/tools</code> en Gemini CLI, se mostrar谩 una lista de herramientas disponibles que se pueden usar para realizar varias tareas, como editar c贸digo, generar pruebas, crear documentaci贸n y m谩s.</p>
<p><img src="assets/gemini_cli_1/tools.png" alt="Tools"></p>
<p><strong>ReadFolder (ls)</strong><br>
Enumera archivos y carpetas en un directorio, similar al comando <code>ls</code> en la l铆nea de comandos.</p>
<p><strong>ReadFile (read-file)</strong><br>
Lee el contenido completo de un solo archivo, 煤til para crear res煤menes o an谩lisis.</p>
<p><strong>ReadManyFiles (read-many-files)</strong><br>
Lee varios archivos a la vez, generalmente por patr贸n (por ejemplo, todos los archivos <code>.js</code>).</p>
<p><strong>FindFiles (glob)</strong><br>
Busca archivos por patr贸n (por ejemplo, encontrar todos los archivos <code>config.json</code> en tu proyecto).</p>
<p><strong>SearchText (grep)</strong><br>
Busca texto dentro de archivos, por ejemplo, para encontrar todos los comentarios <code>TODO</code>.</p>
<p><strong>Edit (edit)</strong><br>
Aplica cambios de c贸digo usando <code>diff</code>. Gemini muestra una vista previa de las ediciones y solicita confirmaci贸n antes de aplicarlas.</p>
<p><strong>WriteFile (write-file)</strong><br>
Crea nuevos archivos (por ejemplo, <code>README.md</code>) con contenido proporcionado por el usuario.</p>
<p><strong>Shell (shell)</strong><br>
Ejecuta comandos directamente en la terminal si los prefijas con <code>!</code> (por ejemplo, <code>!npm test</code>).</p>
<p><strong>WebFetch (web-fetch)</strong><br>
Descarga contenido de la web (HTML o JSON), lo que permite a Gemini analizar datos externos.</p>
<p><strong>GoogleSearch (web-search)</strong><br>
Realiza una b煤squeda en Google para basar las respuestas en informaci贸n del mundo real (por ejemplo, para encontrar una explicaci贸n para un error).</p>
<p><strong>Save Memory (memoryTool)</strong><br>
Guarda hechos o preferencias durante una sesi贸n (por ejemplo, "Prefiero async/await") para mejorar la coherencia y coherencia de las respuestas.</p>
<h3>Funciones avanzadas</h3>
<p>Puedes agregar instrucciones especiales para la IA para un proyecto espec铆fico<br>
creando un archivo <code>GEMINI.md</code> en el directorio ra铆z de tu proyecto.<br>
Dentro de este archivo, puedes definir reglas del proyecto,<br>
estilos de c贸digo y herramientas que el agente debe usar. Esto asegura que el c贸digo generado cumpla con los est谩ndares de tu proyecto.</p>
<p><a href="https://github.com/hypo69/hypotez/blob/master/src/endpoints/hypo69/code_assistant/instructions/CODE_RULES.EN.MD">Example system instruction</a></p>
<h3>Integraci贸n de Google CLI con MCP</h3>
<p>Para la mayor铆a de las tareas diarias, las herramientas integradas ser谩n suficientes. Pero, 驴qu茅 pasa si quieres que Gemini CLI haga algo muy especializado, como interactuar con API espec铆ficas o usar un modelo especializado (por ejemplo, un generador de im谩genes o una herramienta de an谩lisis de seguridad)? Aqu铆 es donde entra en juego el MCP (Protocolo de Contexto del Modelo).</p>
<p>Esencialmente, MCP es un est谩ndar abierto que permite a los desarrolladores agregar nuevas herramientas y capacidades a la IA ejecutando un servidor con el que la CLI puede interactuar. En Gemini CLI, puedes configurar "MCP servidores" en un archivo de configuraci贸n JSON, y la CLI los tratar谩 como herramientas adicionales que puede usar.</p>
<p><h4>C贸mo configurar un servidor MCP en Google CLI</h4>
<p>As an example, I will show you how to set up an MCP server for GitHub in Gemini CLI.</p>
<p>Inside your project folder, create a folder using the command:</p>
<pre class="line-numbers"><code class="language-bash">mkdir -p .gemini && touch .gemini/settings.json
</code></pre>
<p>Fill the file with this code:</p>
<pre class="line-numbers"><code class="language-json">{
  "mcpServers": {
    "github": {
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-github"],
      "env": { "GITHUB_PERSONAL_ACCESS_TOKEN": "[YOUR-TOKEN]" }
    }
  }
}
</code></pre>
<p><a href="https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens#creating-a-personal-access-token-classic">instructions on how to get a token</a><br>
After that, type <code>/quit</code> in Gemini CLI to exit, then open it again.<br>
You will see that the GitHub MCP server is running and ready to use.</p>
<p><img src="assets/gemini_cli_1/mcp.png" alt="MCP"></p>
<p>Type the <code>/mcp</code> command, and you will see a list of GitHub tools.</p>
<p><img src="assets/gemini_cli_1/mcp_commands.png" alt="Mcp Commands"></p>