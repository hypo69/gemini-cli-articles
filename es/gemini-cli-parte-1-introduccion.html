<h2>Gemini CLI: Introducci贸n y primeros pasos.</h2>
<p><strong>Gemini CLI</strong> es una herramienta que funciona directamente en tu terminal, comprende tu base de c贸digo y te ayuda a corregir errores con consultas en lenguaje natural.
Es la respuesta de Google a Claude Code de Anthropic.
Puedes usar Gemini 1.5 Pro (cuando alcances el l铆mite, la herramienta cambiar谩 a Gemini 1.5 Flash) y su ventana de contexto de 1 mill贸n de tokens para realizar hasta 60 solicitudes por minuto y 1000 solicitudes por d铆a, todo de forma gratuita.</p>
<h3>Contenido</h3>
<ul>
<li>Comprender y navegar por grandes bases de c贸digo</li>
<li>Detectar y corregir errores</li>
<li>Escribir y probar c贸digo</li>
<li>Herramientas de Gemini CLI</li>
<li>Integraci贸n de Google CLI con MCP</li>
</ul>
<h3>Caracter铆sticas clave de Gemini CLI:</h3>
<ul>
<li><strong>Edici贸n y refactorizaci贸n:</strong> Mejora y simplifica autom谩ticamente tu c贸digo bajo la gu铆a de la IA.</li>
<li><strong>Detecci贸n y correcci贸n de errores:</strong> Encuentra errores y sugiere soluciones.</li>
<li><strong>Comprensi贸n del c贸digo:</strong> Gemini CLI puede resumir la arquitectura, explicar los roles de los m贸dulos o construir mapas de flujo de ejecuci贸n.</li>
<li><strong>Generaci贸n de pruebas:</strong> Crea autom谩ticamente casos de prueba para <code>pytest</code></li>
<li><strong>Soporte de documentaci贸n:</strong> Puedes crear documentos markdown estructurados, registros de cambios y respuestas a problemas de GitHub directamente en la terminal.</li>
<li><strong>Ejecuci贸n de comandos:</strong> Gemini CLI puede ejecutar comandos de shell como <code>git</code>, <code>npm</code>, <code>pip</code> y otros, lo que te permite administrar proyectos sin salir de la CLI.</li>
</ul>
<hr>
<h3>Paso 1: Requisitos previos</h3>
<p>Para empezar, instala Node.js (versi贸n 18 o superior). Puedes descargar el instalador de tu elecci贸n o ejecutar los siguientes comandos bash en tu terminal:</p>
<pre class="line-numbers"><code class="language-bash">
# Download and install nvm (Node Version Manager):
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.3/install.sh | bash

# Initialize nvm in the current terminal session
. "$HOME/.nvm/nvm.sh"

# Download and install Node.js (e.g., version 22):
nvm install 22

# Check Node.js version:
node -v # Should display "v22.17.0" or similar

# Check npm version:
npm -v # Should display "10.9.2" or similar
</code></pre>
<blockquote>
<p>锔 <strong>Importante para usuarios de Windows:</strong>
El comando <code>nvm</code> anterior es para <strong>Linux/macOS</strong> y <strong>no funcionar谩 en PowerShell o cmd.exe</strong>.
Para Windows, usa <a href="https://github.com/coreybutler/nvm-windows">nvm-windows</a> descargando <code>nvm-setup.exe</code> de la secci贸n <a href="https://github.com/coreybutler/nvm-windows/releases">Releases</a>.
Alternativamente, puedes instalar WSL (Subsistema de Windows para Linux) y ejecutar los comandos en Ubuntu u otra distribuci贸n de Linux.</p>
</blockquote>
<hr>
<h3>Paso 2: Configuraci贸n de Gemini CLI</h3>
<h4>Paso 2.1: Instalaci贸n de Gemini CLI</h4>
<p>Una vez que Node.js y npm est茅n instalados y verificados, instala Gemini CLI ejecutando el siguiente comando en tu terminal:</p>
<pre class="line-numbers"><code class="language-bash">
npx https://github.com/google-gemini/gemini-cli
</code></pre>
<p>O usa <code>npm</code> para instalarlo globalmente:</p>
<pre class="line-numbers"><code class="language-bash">
npm install -g @google/gemini-cli
gemini
</code></pre>
<p>Despu茅s de la instalaci贸n, escribe <code>gemini</code> en la terminal para acceder a la herramienta.</p>
<h4>Paso 2.2: Autenticaci贸n</h4>
<p>Puedes usar tu cuenta personal de Google para autenticarte. Esto te dar谩 hasta 60 solicitudes por minuto y 1000 solicitudes por d铆a al usar Gemini.
<img src="assets/gemini_cli_1/auth.png" alt="First Run"></p>
<p>En esta gu铆a, us茅 <strong>Iniciar sesi贸n con Google</strong>, pero tambi茅n puedes usar una <strong>clave API</strong> (establecida como variable de entorno o en un archivo <code>.env</code>) o autenticarte a trav茅s de <strong>Vertex AI</strong>.</p>
<p>Para generar una nueva clave API, inicia sesi贸n en <strong>AI Studio</strong> con tu cuenta de Google y haz clic en "Crear clave API".</p>
<pre class="line-numbers"><code class="language-bash">
# Set the key as an environment variable
export GEMINI_API_KEY="Your_API_Key"

# Or create a .env file
GEMINI_API_KEY="Your_API_Key"
</code></pre>
<p>Puedes usar el comando <code>/auth</code> en el cuadro de texto para cambiar los m茅todos de autenticaci贸n seg煤n sea necesario.</p>
<hr>
<h3>Paso 3: Configuraci贸n de un proyecto en Gemini CLI</h3>
<p><img src="assets/gemini_cli_1/start.png" alt="Start"></p>
<p>Una vez que la CLI est茅 en funcionamiento, podemos comenzar a interactuar con Gemini desde la terminal. Hay dos formas de trabajar con un proyecto.</p>
<h4>1. Iniciar un nuevo proyecto</h4>
<p>Para iniciar un proyecto desde cero, ejecuta los siguientes comandos:</p>
<pre class="line-numbers"><code class="language-bash">
cd new-project/
gemini
</code></pre>
<p>Dentro de la CLI, usa un prompt para resolver el problema que te interese, por ejemplo:</p>
<blockquote>
<p>Escribe el c贸digo del codificador para un transformador desde cero.</p>
</blockquote>
<p><img src="assets/gemini_cli_1/example_1.png" alt="Example 1"></p>
<p>Da permiso para escribir archivos:</p>
<p><img src="assets/gemini_cli/file.png" alt="File"></p>
<h4>2. Trabajar con un proyecto existente</h4>
<p>Si ya tienes una base de c贸digo, puedes trabajar con ella ejecutando los siguientes comandos:</p>
<pre class="line-numbers"><code class="language-bash">
git clone https://github.com/AashiDutt/Google-Agent-Development-Kit-Demo
cd Google-Agent-Development-Kit-Demo
gemini
</code></pre>
<p>Dentro de la CLI, usa un prompt, por ejemplo:</p>
<blockquote>
<p>Proporci贸name un resumen de todos los cambios realizados en la base de c贸digo en el 煤ltimo mes.</p>
</blockquote>
<hr>
<h3>Paso 4: Experimentando con Gemini CLI</h3>
<p>Como ejemplo, usar茅 el proyecto <strong><a href="https://github.com/AashiDutt/Google-Agent-Development-Kit-Demo">Planificador de viajes  basado en ADK</a></strong>.
Con Gemini CLI, te mostrar茅 c贸mo:</p>
<ol>
<li>explorar la base de c贸digo</li>
<li>detectar un error o problema en GitHub o en un archivo</li>
<li>refactorizar el c贸digo y generar pruebas unitarias</li>
<li>crear un informe markdown de los cambios realizados</li>
<li>visualizar la base de c贸digo generando un diagrama de flujo</li>
</ol>
<h4>Explorando y comprendiendo la base de c贸digo</h4>
<p>Comencemos pidi茅ndole a Gemini que explore y explique la base de c贸digo.</p>
<p><strong>Prompt:</strong> <code>Explora el directorio actual y describe la arquitectura del proyecto.</code></p>
<p>Gemini CLI devolver谩 un resumen estructurado explicando la arquitectura:</p>
<ul>
<li><strong>Interfaz de usuario:</strong> Una aplicaci贸n Streamlit (<code>travel_ui.py</code>) proporciona una interfaz para la interacci贸n.</li>
<li><strong>Orquestaci贸n:</strong> <code>host_agent</code> act煤a como un coordinador central.</li>
<li><strong>Agentes especializados:</strong> <code>flight_agent</code>, <code>stay_agent</code>, <code>activities_agent</code> para buscar vuelos, hoteles y entretenimiento.</li>
<li><strong>Comunicaci贸n:</strong> Los agentes se comunican entre s铆 a trav茅s de una API RESTful en FastAPI.</li>
<li><strong>Componentes compartidos:</strong> <code>shared/schemas.py</code> define estructuras de datos comunes.</li>
</ul>
<p>Esto te ayudar谩 a orientarte sin leer cada archivo manualmente.</p>
<h4>Analizando y corrigiendo un problema de GitHub</h4>
<p>Exploremos algunos problemas abiertos del repositorio de GitHub.</p>
<p><strong>Prompt:</strong> <code>Aqu铆 hay un problema de GitHub: [@search https://github.com/AashiDutt/Google-Agent-Development-Kit-Demo/issues/1]. Analiza la base de c贸digo y prop贸n un plan de correcci贸n de 3 pasos. 驴Qu茅 archivos/funciones deben cambiarse?</code></p>
<p>Gemini CLI investig贸 el problema:</p>
<ul>
<li>Usando la funci贸n <code>@search</code>, recuper贸 datos de GitHub.</li>
<li>Identific贸 la causa ra铆z como un error de serializaci贸n JSON (en este caso, la funci贸n as铆ncrona <code>create_session()</code> no se llam贸 con <code>await</code>).</li>
<li>Sugiri贸 cambios y manejo de respuestas en varios archivos.</li>
</ul>
<p>A continuaci贸n, la CLI espera la entrada del usuario para evaluar los cambios. Si el usuario est谩 de acuerdo, aplicar谩 los cambios sugeridos.</p>
<h4>Implementando y probando la correcci贸n</h4>
<p>Ahora implementemos y probemos las correcciones sugeridas por Gemini.</p>
<p><strong>Prompt:</strong> <code>Escribe una prueba unitaria para este cambio en pytest en el archivo test_shared.py.</code></p>
<p>Gemini CLI:</p>
<ul>
<li>Insert贸 <code>json.dumps()</code> antes de enviar la carga 煤til de la tarea.</li>
<li>Cre贸 <code>test_agents.py</code> para agregar pruebas unitarias.</li>
<li>Agreg贸 un nuevo caso de prueba para verificar el esquema y la transferencia de mensajes de agente anidados.</li>
</ul>
<h4>Generando documentaci贸n</h4>
<p>Ahora que se han realizado las correcciones, resumamos los cambios y escrib谩moslos en Markdown en un archivo <code>.txt</code>.</p>
<p><strong>Prompt:</strong> <code>Escribe un resumen markdown del error, la correcci贸n y la cobertura de las pruebas. Formatea esto como una entrada de registro de cambios bajo la versi贸n "v0.2.0".</code></p>
<p>Luego, para guardar el resumen en un documento, us茅 el siguiente prompt:</p>
<p><strong>Prompt:</strong> <code>Guarda este resumen en un archivo .txt y n贸mbralo summary.txt</code></p>
<p>Gemini CLI usa la herramienta <code>WriteFile</code> para guardar el archivo <code>summary.txt</code> en el directorio del proyecto.</p>
<h4>Generando un diagrama de flujo usando MCP</h4>
<p>Esta secci贸n ampl铆a los experimentos anteriores donde exploro c贸mo Gemini CLI usa el <strong>Protocolo de contexto del modelo (MCP)</strong> para mantener res煤menes a nivel de archivo e historial de tareas entre prompts. Esto le da a Gemini una "memoria de trabajo" dentro de una sesi贸n.</p>
<p><strong>Prompt:</strong> <code>Genera un diagrama de flujo que muestre c贸mo los agentes se comunican a trav茅s de A2A (agente a agente) y c贸mo main.py gestiona el sistema. Resalta d贸nde ocurri贸 el problema y c贸mo se solucion贸.</code></p>
<p>Esta visualizaci贸n fue posible gracias a la memoria persistente de Gemini, que retuvo el contexto completo de nuestra correcci贸n de errores anterior y la estructura del agente sin tener que recargar los archivos.</p>
<h3>Herramientas de Gemini CLI disponibles</h3>
<p>Al llamar al comando <code>/tools</code> en Gemini CLI, se mostrar谩 una lista de herramientas disponibles que se pueden usar para realizar varias tareas, como editar c贸digo, generar pruebas, crear documentaci贸n y mucho m谩s.
<img src="assets/gemini_cli_1/tools.png" alt="Tools"></p>
<p><strong>ReadFolder (ls)</strong>
Lista archivos y carpetas en un directorio, an谩logo al comando <code>ls</code> en la l铆nea de comandos.</p>
<p><strong>ReadFile (read-file)</strong>
Lee el contenido completo de un solo archivo, lo cual es 煤til para crear res煤menes o an谩lisis.</p>
<p><strong>ReadManyFiles (read-many-files)</strong>
Lee varios archivos a la vez, generalmente por un patr贸n (por ejemplo, todos los archivos <code>.js</code>).</p>
<p><strong>FindFiles (glob)</strong>
Busca archivos por un patr贸n (por ejemplo, encontrar todos los archivos <code>config.json</code> en tu proyecto).</p>
<p><strong>SearchText (grep)</strong>
Busca texto dentro de los archivos, por ejemplo, para encontrar todos los comentarios <code>TODO</code>.</p>
<p><strong>Edit (edit)</strong>
Aplica cambios de c贸digo usando un <code>diff</code>. Gemini muestra una vista previa de las ediciones y solicita confirmaci贸n antes de aplicarlas.</p>
<p><strong>WriteFile (write-file)</strong>
Crea nuevos archivos (por ejemplo, <code>README.md</code>) con el contenido proporcionado por el usuario.</p>
<p><strong>Shell (shell)</strong>
Ejecuta comandos directamente en la terminal si los prefijas con <code>!</code> (por ejemplo, <code>!npm test</code>).</p>
<p><strong>WebFetch (web-fetch)</strong>
Descarga contenido de la web (HTML o JSON), lo que permite a Gemini analizar datos externos.</p>
<p><strong>GoogleSearch (web-search)</strong>
Realiza una b煤squeda en Google para basar las respuestas en informaci贸n real (por ejemplo, para encontrar una explicaci贸n para un error).</p>
<p><strong>Save Memory (memoryTool)</strong>
Guarda hechos o preferencias durante una sesi贸n (por ejemplo, "prefiero async/await") para mejorar la coherencia y coherencia de las respuestas.</p>
<h3>Funciones avanzadas</h3>
<p>Puedes a帽adir instrucciones especiales para la IA para un proyecto espec铆fico
creando un archivo <code>GEMINI.md</code> en el directorio ra铆z de tu proyecto.
Dentro de este archivo, puedes definir las reglas del proyecto,
los estilos de c贸digo y las herramientas que el agente debe usar. Esto asegura que el c贸digo generado cumpla con los est谩ndares de tu proyecto.</p>
<p><a href="https://github.com/hypo69/hypotez/blob/master/src/endpoints/hypo69/code_assistant/instructions/CODE_RULES.EN.MD">Ejemplo de una instrucci贸n del sistema</a></p>
<h3>Integraci贸n de Google CLI con MCP</h3>
<p>Para la mayor铆a de las tareas diarias, las herramientas integradas ser谩n suficientes. Pero, 驴qu茅 pasa si quieres que Gemini CLI haga algo muy especializado, como interactuar con API espec铆ficas o usar un modelo especializado (por ejemplo, un generador de im谩genes o una herramienta de an谩lisis de seguridad)? Aqu铆 es donde entra en juego el MCP (Protocolo de contexto del modelo).</p>
<p>En esencia, MCP es un est谩ndar abierto que permite a los desarrolladores a帽adir nuevas herramientas y capacidades a la IA ejecutando un servidor con el que la CLI puede interactuar. En Gemini CLI, puedes configurar "servidores MCP" en un archivo de configuraci贸n JSON, y la CLI los tratar谩 como herramientas adicionales que puede usar.</p>
<h4>C贸mo configurar un servidor MCP en Google CLI</h4>
<p>Como ejemplo, te mostrar茅 c贸mo configurar un servidor MCP para GitHub en Gemini CLI.</p>
<p>Dentro de la carpeta de tu proyecto, crea una carpeta con el comando:</p>
<pre class="line-numbers"><code class="language-bash">
mkdir -p .gemini && touch .gemini/settings.json
</code></pre>
<p>Rellena el archivo con este c贸digo:</p>
<pre class="line-numbers"><code class="language-json">
{
  "mcpServers": {
    "github": {
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-github"],
      "env": { "GITHUB_PERSONAL_ACCESS_TOKEN": "[YOUR-TOKEN]" }
    }
  }
}
</code></pre>
<p><a href="https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens#creating-a-personal-access-token-classic">instrucciones sobre c贸mo obtener un token</a>
Despu茅s de eso, escribe <code>/quit</code> en Gemini CLI para salir, y luego 谩brelo de nuevo.
Ver谩s que el servidor MCP de GitHub est谩 en funcionamiento y listo para usar.
<img src="assets/gemini_cli_1/mcp.png" alt="MCP">
Introduce el comando <code>/mcp</code>, y ver谩s una lista de herramientas de GitHub.
<img src="assets/gemini_cli_1/mcp_commands.png" alt="Mcp Commands"></p>