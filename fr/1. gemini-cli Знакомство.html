<h2>Gemini CLI : Introduction et premiers pas.</h2>
<p><strong>Gemini CLI</strong> est un outil qui fonctionne directement dans votre terminal, comprend votre base de code et aide √† corriger les erreurs √† l'aide de requ√™tes en langage naturel. C'est la r√©ponse de Google √† Claude Code d'Anthropic.
Vous pouvez utiliser Gemini 2.5 Pro (l'outil basculera vers Gemini 2.5 Flash si la limite est atteinte) et sa fen√™tre contextuelle de 1 million de jetons pour effectuer jusqu'√† 60 requ√™tes par minute et 1000 requ√™tes par jour, le tout gratuitement.</p>
<h3>Contenu</h3>
<ul>
<li>Comprendre et naviguer dans de grandes bases de code</li>
<li>D√©tecter et corriger les bogues</li>
<li>√âcrire et tester du code</li>
<li>Outils Gemini CLI</li>
<li>Int√©gration de Google CLI avec MCP</li>
</ul>
<h3>Principales fonctionnalit√©s de Gemini CLI :</h3>
<ul>
<li><strong>√âdition et refactoring :</strong> Am√©liore et simplifie automatiquement votre code sous la direction de l'IA.</li>
<li><strong>D√©tection et correction des bogues :</strong> Trouve les bogues et sugg√®re des corrections.</li>
<li><strong>Compr√©hension du code :</strong> Gemini CLI peut r√©sumer l'architecture, expliquer les r√¥les des modules ou construire des cartes de flux d'ex√©cution.</li>
<li><strong>G√©n√©ration de tests :</strong> Cr√©e automatiquement des cas de test pour <code>pytest</code></li>
<li><strong>Support de documentation :</strong> Vous pouvez cr√©er des documents Markdown structur√©s, des journaux de modifications (changelogs) et r√©pondre aux probl√®mes GitHub directement dans le terminal.
<li><strong>Ex√©cution de commandes :</strong> Gemini CLI peut ex√©cuter des commandes shell telles que <code>git</code>, <code>npm</code>, <code>pip</code> et d'autres, vous permettant de g√©rer des projets sans quitter la CLI.</li>
</ul>
<hr>
<h3>√âtape 1 : Pr√©requis</h3>
<p>Pour commencer, installez Node.js (version 18 ou sup√©rieure). Vous pouvez t√©l√©charger l'installateur de votre choix ou ex√©cuter les commandes bash suivantes dans votre terminal :</p>
<pre class="line-numbers"><code class="language-bash"># T√©l√©chargement et installation de nvm (Node Version Manager) :
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.3/install.sh | bash

# Initialisation de nvm dans la session de terminal actuelle
. "$HOME/.nvm/nvm.sh"

# T√©l√©chargement et installation de Node.js (par exemple, version 22) :
nvm install 22

# V√©rification de la version de Node.js :
node -v # Devrait afficher "v22.17.0" ou similaire

# V√©rification de la version de npm :
npm -v # Devrait afficher "10.9.2" ou similaire
</code></pre>
<blockquote>
<p>‚ö†Ô∏è <strong>Important pour les utilisateurs de Windows :</strong>
La commande <code>nvm</code> ci-dessus est destin√©e √† <strong>Linux/macOS</strong> et <strong>ne fonctionnera pas dans PowerShell ou cmd.exe</strong>.
Pour Windows, utilisez <a href="https://github.com/coreybutler/nvm-windows">nvm-windows</a>, en t√©l√©chargeant <code>nvm-setup.exe</code> depuis la section <a href="https://github.com/coreybutler/nvm-windows/releases">Releases</a>.
Alternativement, vous pouvez installer WSL (Windows Subsystem for Linux) et ex√©cuter les commandes dans Ubuntu ou une autre distribution Linux.</p>
</blockquote>
<hr>
<h3>√âtape 2 : Configuration de Gemini CLI</h3>
<h4>√âtape 2.1 : Installation de Gemini CLI</h4>
<p>Une fois que Node.js et npm sont install√©s et v√©rifi√©s, installez Gemini CLI en ex√©cutant la commande suivante dans votre terminal :</p>
<pre class="line-numbers"><code class="language-bash">npx https://github.com/google-gemini/gemini-cli
</code></pre>
<p>Ou utilisez <code>npm</code> pour une installation globale :</p>
<pre class="line-numbers"><code class="language-bash">npm install -g @google/gemini-cli
gemini
</code></pre>
<p>Apr√®s l'installation, tapez <code>gemini</code> dans votre terminal pour acc√©der √† l'outil.</p>
<h4>√âtape 2.2 : Authentification</h4>
<p>Vous pouvez utiliser votre compte Google personnel pour l'authentification. Cela vous donnera jusqu'√† 60 requ√™tes par minute et 1000 requ√™tes par jour lorsque vous utilisez Gemini.
<p><img src="assets/gemini_cli_1/auth.png" alt="First Run"></p>
<p>Dans ce guide, j'ai utilis√© <strong>Se connecter avec Google</strong>, mais vous pouvez √©galement utiliser une <strong>cl√© API</strong> (d√©finie comme variable d'environnement ou dans un fichier <code>.env</code>) ou l'authentification <strong>Vertex AI</strong>.</p>
<p>Pour g√©n√©rer une nouvelle cl√© API, connectez-vous √† <strong>AI Studio</strong> avec votre compte Google et cliquez sur "Cr√©er une cl√© API".</p>
<pre class="line-numbers"><code class="language-bash"># D√©finir la cl√© comme variable d'environnement
export GEMINI_API_KEY="Your_API_Key"

# Ou cr√©er un fichier .env
GEMINI_API_KEY="Your_API_Key"
</code></pre>
<p>Vous pouvez utiliser la commande <code>/auth</code> dans le champ de texte pour changer les m√©thodes d'authentification si n√©cessaire.</p>
<hr>
<h3>√âtape 3 : Configuration d'un projet dans Gemini CLI</h3>
<p><img src="assets/gemini_cli_1/start.png" alt="Start"></p>
<p>Une fois la CLI en cours d'ex√©cution, nous pouvons commencer √† interagir avec Gemini depuis le terminal. Il existe deux fa√ßons de travailler avec un projet.</p>
<h4>1. D√©marrer un nouveau projet</h4>
<p>Pour d√©marrer un projet √† partir de z√©ro, ex√©cutez les commandes suivantes :
<pre class="line-numbers"><code class="language-bash">cd new-project/
gemini
</code></pre>
<p>Dans la CLI, utilisez une invite pour r√©soudre le probl√®me qui vous int√©resse, par exemple :
<blockquote>
<p>√âcrivez le code de l'encodeur pour un transformateur √† partir de z√©ro.</p>
</blockquote>
<p><img src="assets/gemini_cli_1/example_1.png" alt="Example 1"></p>
<p>Accorder la permission d'√©crire des fichiers :
<p><img src="assets/gemini_cli/file.png" alt="File"></p>
<h4>2. Travailler avec un projet existant</h4>
<p>Si vous avez d√©j√† une base de code, vous pouvez travailler avec elle en ex√©cutant les commandes suivantes :
<pre class="line-numbers"><code class="language-bash">git clone https://github.com/AashiDutt/Google-Agent-Development-Kit-Demo
cd Google-Agent-Development-Kit-Demo
gemini
</code></pre>
<p>Dans la CLI, utilisez une invite, par exemple :
<blockquote>
<p>Fournissez-moi un r√©sum√© de toutes les modifications apport√©es √† la base de code au cours du dernier mois.</p>
</blockquote>
<hr>
<h3>√âtape 4 : Exp√©rimenter avec Gemini CLI</h3>
<p>√Ä titre d'exemple, j'utiliserai le projet <strong><a href="https://github.com/AashiDutt/Google-Agent-Development-Kit-Demo">Planificateur de voyages bas√© sur ADK üåçüõ´</a></strong>.
Avec Gemini CLI, je vais montrer comment :
<ol>
<li>explorer la base de code</li>
<li>d√©tecter un bogue ou un probl√®me sur GitHub ou dans un fichier</li>
<li>refactoriser le code et g√©n√©rer des tests unitaires</li>
<li>cr√©er un rapport Markdown des modifications apport√©es</li>
<li>visualiser la base de code en g√©n√©rant un organigramme</li>
</ol>
<h4>Explorer et comprendre la base de code</h4>
<p>Commen√ßons par demander √† Gemini d'explorer et d'expliquer la base de code.</p>
<p><strong>Invite :</strong> <code>Explorez le r√©pertoire actuel et d√©crivez l'architecture du projet.</code></p>
<p>Gemini CLI renverra un r√©sum√© structur√© expliquant l'architecture :
<ul>
<li><strong>Interface utilisateur :</strong> Une application Streamlit (<code>travel_ui.py</code>) fournit une interface d'interaction.</li>
<li><strong>Orchestration :</strong> <code>host_agent</code> agit comme un coordinateur central.</li>
<li><strong>Agents sp√©cialis√©s :</strong> <code>flight_agent</code>, <code>stay_agent</code>, <code>activities_agent</code> pour la recherche de vols, d'h√¥tels et d'activit√©s.</li>
<li><strong>Communication :</strong> Les agents communiquent entre eux via une API RESTful FastAPI.</li>
<li><strong>Composants partag√©s :</strong> <code>shared/schemas.py</code> d√©finit les structures de donn√©es communes.</li>
</ul>
<p>Cela vous aidera √† naviguer sans lire chaque fichier manuellement.</p>
<h4>Analyser et corriger un probl√®me GitHub</h4>
<p>Explorons quelques probl√®mes ouverts du r√©f√©rentiel GitHub.</p>
<p><strong>Invite :</strong> <code>Voici un probl√®me GitHub : [@search https://github.com/AashiDutt/Google-Agent-Development-Kit-Demo/issues/1]. Analysez la base de code et proposez un plan de correction en 3 √©tapes. Quels fichiers/fonctions doivent √™tre modifi√©s ?</code></p>
<p>Gemini CLI a enqu√™t√© sur le probl√®me :
<ul>
<li>En utilisant la fonction <code>@search</code>, il a r√©cup√©r√© des donn√©es de GitHub.</li>
<li>A identifi√© la cause premi√®re comme une erreur de s√©rialisation JSON (dans ce cas, la fonction asynchrone <code>create_session()</code> n'a pas √©t√© appel√©e avec <code>await</code>).</li>
<li>A sugg√©r√© des modifications et la gestion des r√©ponses dans plusieurs fichiers.</li>
</ul>
<p>Ensuite, la CLI attend l'entr√©e de l'utilisateur pour √©valuer les modifications. Si l'utilisateur est d'accord, elle appliquera les modifications sugg√©r√©es.</p>
<h4>Impl√©menter et tester la correction</h4>
<p>Maintenant, impl√©mentons et testons les corrections sugg√©r√©es par Gemini.</p>
<p><strong>Invite :</strong> <code>√âcrivez un test unitaire pour cette modification dans pytest dans le fichier test_shared.py.</code></p>
<p>Gemini CLI :
<ul>
<li>A ins√©r√© <code>json.dumps()</code> avant d'envoyer la charge utile de la t√¢che.</li>
<li>A cr√©√© <code>test_agents.py</code> pour ajouter des tests unitaires.</li>
<li>A ajout√© un nouveau cas de test pour v√©rifier le sch√©ma et transmettre les messages d'agent imbriqu√©s.</li>
</ul>
<h4>G√©n√©ration de documentation</h4>
<p>Maintenant que les corrections ont √©t√© appliqu√©es, r√©sumons les modifications et √©crivons-les en Markdown dans un fichier <code>.txt</code>.</p>
<p><strong>Invite :</strong> <code>√âcrivez un r√©sum√© Markdown du bogue, de la correction et de la couverture des tests. Formatez-le comme une entr√©e de journal des modifications sous la version "v0.2.0".</code></p>
<p>Ensuite, pour enregistrer le r√©sum√© dans un document, j'ai utilis√© l'invite suivante :
<p><strong>Invite :</strong> <code>Enregistrez ce r√©sum√© dans un fichier .txt et nommez-le summary.txt</code></p>
<p>Gemini CLI utilise l'outil <code>WriteFile</code> pour enregistrer le fichier <code>summary.txt</code> dans le r√©pertoire du projet.</p>
<h4>G√©n√©ration d'un organigramme √† l'aide de MCP</h4>
<p>Cette section √©tend les exp√©riences pr√©c√©dentes o√π j'explore comment Gemini CLI utilise le <strong>Protocole de Contexte de Mod√®le (MCP)</strong> pour maintenir des r√©sum√©s au niveau des fichiers et l'historique des t√¢ches entre les invites. Cela donne √† Gemini une "m√©moire de travail" au sein d'une session.</p>
<p><strong>Invite :</strong> <code>G√©n√©rez un organigramme qui montre comment les agents communiquent via A2A (agent √† agent) et comment main.py g√®re le syst√®me. Mettez en √©vidence o√π le probl√®me s'est produit et comment il a √©t√© r√©solu.</code></p>
<p>Cette visualisation a √©t√© rendue possible gr√¢ce √† la m√©moire persistante de Gemini, qui a conserv√© le contexte complet de notre pr√©c√©dente correction de bogue et de la structure de l'agent sans avoir besoin de recharger les fichiers.</p>
<h3>Outils Gemini CLI disponibles</h3>
<p>L'appel de la commande <code>/tools</code> dans Gemini CLI affichera une liste des outils disponibles qui peuvent √™tre utilis√©s pour effectuer diverses t√¢ches, telles que l'√©dition de code, la g√©n√©ration de tests, la cr√©ation de documentation, etc.</p>
<p><img src="assets/gemini_cli_1/tools.png" alt="Tools"></p>
<p><strong>ReadFolder (ls)</strong><br>
Liste les fichiers et dossiers dans un r√©pertoire ‚Äî similaire √† la commande <code>ls</code> dans la ligne de commande.</p>
<p><strong>ReadFile (read-file)</strong><br>
Lit le contenu complet d'un seul fichier, utile pour cr√©er des r√©sum√©s ou des analyses.</p>
<p><strong>ReadManyFiles (read-many-files)</strong><br>
Lit plusieurs fichiers √† la fois, g√©n√©ralement par motif (par exemple, tous les fichiers <code>.js</code>).</p>
<p><strong>FindFiles (glob)</strong><br>
Recherche des fichiers par motif (par exemple, trouver tous les fichiers <code>config.json</code> dans votre projet).</p>
<p><strong>SearchText (grep)</strong><br>
Recherche du texte dans les fichiers, par exemple, pour trouver tous les commentaires <code>TODO</code>.</p>
<p><strong>Edit (edit)</strong><br>
Applique les modifications de code √† l'aide de <code>diff</code>. Gemini affiche un aper√ßu des modifications et demande une confirmation avant de les appliquer.</p>
<p><strong>WriteFile (write-file)</strong><br>
Cr√©e de nouveaux fichiers (par exemple, <code>README.md</code>) avec le contenu fourni par l'utilisateur.</p>
<p><strong>Shell (shell)</strong><br>
Ex√©cute des commandes directement dans le terminal si vous les pr√©fixez avec <code>!</code> (par exemple, <code>!npm test</code>).</p>
<p><strong>WebFetch (web-fetch)</strong><br>
T√©l√©charge du contenu du web (HTML ou JSON), permettant √† Gemini d'analyser des donn√©es externes.</p>
<p><strong>GoogleSearch (web-search)</strong><br>
Effectue une recherche Google pour baser les r√©ponses sur des informations du monde r√©el (par exemple, pour trouver une explication √† une erreur).</p>
<p><strong>Save Memory (memoryTool)</strong><br>
Enregistre des faits ou des pr√©f√©rences pendant une session (par exemple, "Je pr√©f√®re async/await") pour am√©liorer la coh√©rence des r√©ponses.</p>
<h3>Fonctionnalit√©s avanc√©es</h3>
<p>Vous pouvez ajouter des instructions sp√©ciales pour l'IA pour un projet sp√©cifique en<br>
cr√©ant un fichier <code>GEMINI.md</code> dans le r√©pertoire racine de votre projet.<br>
Dans ce fichier, vous pouvez d√©finir les r√®gles du projet,<br>
les styles de code et les outils que l'agent doit utiliser. Cela garantit que le code g√©n√©r√© est conforme aux normes de votre projet.</p>
<p><a href="https://github.com/hypo69/hypotez/blob/master/src/endpoints/hypo69/code_assistant/instructions/CODE_RULES.EN.MD">Exemple d'instruction syst√®me</a></p>
<h3>Int√©gration de Google CLI avec MCP</h3>
<p>Pour la plupart des t√¢ches quotidiennes, les outils int√©gr√©s suffiront. Mais que se passe-t-il si vous souhaitez que Gemini CLI fasse quelque chose de tr√®s sp√©cialis√©, comme interagir avec des API sp√©cifiques ou utiliser un mod√®le sp√©cialis√© (par exemple, un g√©n√©rateur d'images ou un outil d'analyse de s√©curit√©) ? C'est l√† qu'intervient le MCP (Model Context Protocol).</p>
<p>Essentiellement, le MCP est une norme ouverte qui permet aux d√©veloppeurs d'ajouter de nouveaux outils et capacit√©s √† l'IA en ex√©cutant un serveur avec lequel la CLI peut interagir. Dans Gemini CLI, vous pouvez configurer des "serveurs MCP" dans un fichier de param√®tres JSON, et la CLI les traitera comme des outils suppl√©mentaires qu'elle peut utiliser.</p>
<h4>Comment configurer un serveur MCP dans Google CLI</h4>
<p>√Ä titre d'exemple, je vais vous montrer comment configurer un serveur MCP pour GitHub dans Gemini CLI.</p>
<p>Dans le dossier de votre projet, cr√©ez un dossier √† l'aide de la commande :
<pre class="line-numbers"><code class="language-bash">mkdir -p .gemini && touch .gemini/settings.json
</code></pre>
<p>Remplissez le fichier avec ce code :
<pre class="line-numbers"><code class="language-json">{
  "mcpServers": {
    "github": {
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-github"],
      "env": { "GITHUB_PERSONAL_ACCESS_TOKEN": "[YOUR-TOKEN]" }
    }
  }
}
</code></pre>
<p><a href="https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens#creating-a-personal-access-token-classic">instructions sur la fa√ßon d'obtenir un jeton</a><br>
Apr√®s cela, tapez <code>/quit</code> dans Gemini CLI pour quitter, puis rouvrez-le.
Vous verrez que le serveur MCP de GitHub est en cours d'ex√©cution et pr√™t √† l'emploi.</p>
<p><img src="assets/gemini_cli_1/mcp.png" alt="MCP"></p>
<p>Tapez la commande <code>/mcp</code>, et vous verrez une liste des outils GitHub.</p>
<p><img src="assets/gemini_cli_1/mcp_commands.png" alt="Mcp Commands"></p>