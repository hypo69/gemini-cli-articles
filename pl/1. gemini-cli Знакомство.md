## Gemini CLI: Wprowadzenie i pierwsze kroki.

**Gemini CLI** to narzÄ™dzie, ktÃ³re dziaÅ‚a bezpoÅ›rednio w Twoim terminalu, rozumie TwojÄ… bazÄ™ kodu i pomaga naprawiaÄ‡ bÅ‚Ä™dy za pomocÄ… zapytaÅ„ w jÄ™zyku naturalnym. To odpowiedÅº Google na Claude Code firmy Anthropic.
MoÅ¼esz uÅ¼ywaÄ‡ Gemini 2.5 Pro (narzÄ™dzie przeÅ‚Ä…czy siÄ™ na Gemini 2.5 Flash po osiÄ…gniÄ™ciu limitu) i jego okna kontekstowego o pojemnoÅ›ci 1 miliona tokenÃ³w, aby wykonywaÄ‡ do 60 zapytaÅ„ na minutÄ™ i 1000 zapytaÅ„ dziennie, a wszystko to za darmo.

### Spis treÅ›ci
*   Zrozumienie i nawigacja po duÅ¼ych bazach kodu
*   Wykrywanie i naprawianie bÅ‚Ä™dÃ³w
*   Pisanie i testowanie kodu
*   NarzÄ™dzia Gemini CLI
*   Integracja Google CLI z MCP

### Kluczowe funkcje Gemini CLI:
*   **Edycja i refaktoryzacja:** Automatycznie poprawia i upraszcza TwÃ³j kod pod kierunkiem AI.
*   **Wykrywanie i naprawianie bÅ‚Ä™dÃ³w:** Znajduje bÅ‚Ä™dy i sugeruje poprawki.
*   **Zrozumienie kodu:** Gemini CLI moÅ¼e podsumowaÄ‡ architekturÄ™, wyjaÅ›niÄ‡ role moduÅ‚Ã³w lub zbudowaÄ‡ mapy przepÅ‚ywu wykonania.
*   **Generowanie testÃ³w:** Automatycznie tworzy przypadki testowe dla `pytest`
*   **Wsparcie dokumentacji:** MoÅ¼esz tworzyÄ‡ ustrukturyzowane dokumenty Markdown, dzienniki zmian (changelogi) i odpowiadaÄ‡ na problemy GitHub bezpoÅ›rednio w terminalu.
*   **Wykonywanie poleceÅ„:** Gemini CLI moÅ¼e wykonywaÄ‡ polecenia powÅ‚oki, takie jak `git`, `npm`, `pip` i inne, co pozwala zarzÄ…dzaÄ‡ projektami bez wychodzenia z CLI.

---

### Krok 1: Wymagania wstÄ™pne

Aby rozpoczÄ…Ä‡, zainstaluj Node.js (wersja 18 lub nowsza). MoÅ¼esz pobraÄ‡ instalator wedÅ‚ug wÅ‚asnego wyboru lub uruchomiÄ‡ nastÄ™pujÄ…ce polecenia bash w swoim terminalu:

```bash
# Pobieranie i instalacja nvm (Node Version Manager):
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.3/install.sh | bash

# Inicjalizacja nvm w bieÅ¼Ä…cej sesji terminala
. "$HOME/.nvm/nvm.sh"

# Pobieranie i instalacja Node.js (np. wersja 22):
nvm install 22

# Sprawdzenie wersji Node.js:
node -v # Powinno wyÅ›wietliÄ‡ "v22.17.0" lub podobne

# Sprawdzenie wersji npm:
npm -v # Powinno wyÅ›wietliÄ‡ "10.9.2" lub podobne
```

> âš ï¸ **WaÅ¼ne dla uÅ¼ytkownikÃ³w Windows:**
> PowyÅ¼sze polecenie `nvm` jest przeznaczone dla **Linux/macOS** i **nie bÄ™dzie dziaÅ‚aÄ‡ w PowerShell ani cmd.exe**.
> Dla systemu Windows uÅ¼yj [nvm-windows](https://github.com/coreybutler/nvm-windows), pobierajÄ…c `nvm-setup.exe` z sekcji [Releases](https://github.com/coreybutler/nvm-windows/releases).
> Alternatywnie moÅ¼esz zainstalowaÄ‡ WSL (Windows Subsystem for Linux) i uruchomiÄ‡ polecenia w Ubuntu lub innej dystrybucji Linuksa.

---
### Krok 2: Konfiguracja Gemini CLI

#### Krok 2.1: Instalacja Gemini CLI
Po zainstalowaniu i zweryfikowaniu Node.js i npm, zainstaluj Gemini CLI, uruchamiajÄ…c nastÄ™pujÄ…ce polecenie w swoim terminalu:

```bash
npx https://github.com/google-gemini/gemini-cli
```
Lub uÅ¼yj `npm` do globalnej instalacji:
```bash
npm install -g @google/gemini-cli
gemini
```
Po instalacji wpisz `gemini` w terminalu, aby uzyskaÄ‡ dostÄ™p do narzÄ™dzia.

#### Krok 2.2: Uwierzytelnianie
MoÅ¼esz uÅ¼yÄ‡ swojego osobistego konta Google do uwierzytelniania. Zapewni to do 60 zapytaÅ„ na minutÄ™ i 1000 zapytaÅ„ dziennie podczas korzystania z Gemini.
![First Run](assets/gemini_cli_1/auth.png)

W tym przewodniku uÅ¼yÅ‚em **Zaloguj siÄ™ przez Google**, ale moÅ¼esz rÃ³wnieÅ¼ uÅ¼yÄ‡ **klucza API** (ustawionego jako zmienna Å›rodowiskowa lub w pliku `.env`) lub uwierzytelniania **Vertex AI**.

Aby wygenerowaÄ‡ nowy klucz API, zaloguj siÄ™ do **AI Studio** za pomocÄ… swojego konta Google i kliknij "UtwÃ³rz klucz API".
```bash
# Ustaw klucz jako zmiennÄ… Å›rodowiskowÄ…
export GEMINI_API_KEY="Your_API_Key"

# Lub utwÃ³rz plik .env
GEMINI_API_KEY="Your_API_Key"
```
MoÅ¼esz uÅ¼yÄ‡ polecenia `/auth` w polu tekstowym, aby w razie potrzeby przeÅ‚Ä…czyÄ‡ metody uwierzytelniania.

---

### Krok 3: Konfiguracja projektu w Gemini CLI
![Start](assets/gemini_cli_1/start.png)
Po uruchomieniu CLI moÅ¼emy rozpoczÄ…Ä‡ interakcjÄ™ z Gemini z terminala. IstniejÄ… dwa sposoby pracy z projektem.

#### 1. Rozpocznij nowy projekt
Aby rozpoczÄ…Ä‡ projekt od zera, uruchom nastÄ™pujÄ…ce polecenia:
```bash
cd new-project/
gemini
```
WewnÄ…trz CLI uÅ¼yj monitu, aby rozwiÄ…zaÄ‡ interesujÄ…cy CiÄ™ problem, na przykÅ‚ad:
> Napisz kod kodera dla transformatora od podstaw.
![Example 1](assets/gemini_cli_1/example_1.png)
Udziel pozwolenia na zapisywanie plikÃ³w:
![File](assets/gemini_cli/file.png)

#### 2. Pracuj z istniejÄ…cym projektem
JeÅ›li masz juÅ¼ bazÄ™ kodu, moÅ¼esz z niÄ… pracowaÄ‡, uruchamiajÄ…c nastÄ™pujÄ…ce polecenia:
```bash
git clone https://github.com/AashiDutt/Google-Agent-Development-Kit-Demo
cd Google-Agent-Development-Kit-Demo
gemini
```
WewnÄ…trz CLI uÅ¼yj monitu, na przykÅ‚ad:
> Podaj mi podsumowanie wszystkich zmian wprowadzonych w bazie kodu w ciÄ…gu ostatniego miesiÄ…ca.

---

### Krok 4: Eksperymentowanie z Gemini CLI
Jako przykÅ‚ad uÅ¼yjÄ™ projektu **[Planer podrÃ³Å¼y oparty na ADK ğŸŒğŸ›«](https://github.com/AashiDutt/Google-Agent-Development-Kit-Demo)**.
Z Gemini CLI pokaÅ¼Ä™, jak:
1.  przeglÄ…daÄ‡ bazÄ™ kodu
2.  wykrywaÄ‡ bÅ‚Ä™dy lub problemy na GitHubie lub w pliku
3.  refaktoryzowaÄ‡ kod i generowaÄ‡ testy jednostkowe
4.  tworzyÄ‡ raport Markdown z wprowadzonych zmian
5.  wizualizowaÄ‡ bazÄ™ kodu, generujÄ…c schemat blokowy

#### PrzeglÄ…danie i zrozumienie bazy kodu
Zacznijmy od poproszenia Gemini o przejrzenie i wyjaÅ›nienie bazy kodu.

**Monit:** `PrzeglÄ…daj bieÅ¼Ä…cy katalog i opisz architekturÄ™ projektu.`

Gemini CLI zwrÃ³ci ustrukturyzowane podsumowanie wyjaÅ›niajÄ…ce architekturÄ™:
*   **Interfejs uÅ¼ytkownika:** Aplikacja Streamlit (`travel_ui.py`) zapewnia interfejs do interakcji.
*   **Orkiestracja:** `host_agent` dziaÅ‚a jako centralny koordynator.
*   **Wyspecjalizowani agenci:** `flight_agent`, `stay_agent`, `activities_agent` do wyszukiwania lotÃ³w, hoteli i atrakcji.
*   **Komunikacja:** Agenci komunikujÄ… siÄ™ ze sobÄ… za poÅ›rednictwem interfejsu API RESTful FastAPI.
*   **WspÃ³lne komponenty:** `shared/schemas.py` definiuje wspÃ³lne struktury danych.

PomoÅ¼e to w nawigacji bez rÄ™cznego czytania kaÅ¼dego pliku.

#### Analiza i naprawa problemu GitHub
Przyjrzyjmy siÄ™ kilku otwartym problemom z repozytorium GitHub.

**Monit:** `Oto problem GitHub: [@search https://github.com/AashiDutt/Google-Agent-Development-Kit-Demo/issues/1]. Przeanalizuj bazÄ™ kodu i zaproponuj 3-etapowy plan naprawy. KtÃ³re pliki/funkcje naleÅ¼y zmieniÄ‡?`

Gemini CLI zbadaÅ‚ problem:
*   KorzystajÄ…c z funkcji `@search`, pobraÅ‚ dane z GitHuba.
*   ZidentyfikowaÅ‚ gÅ‚Ã³wnÄ… przyczynÄ™ jako bÅ‚Ä…d serializacji JSON (w tym przypadku asynchroniczna funkcja `create_session()` nie zostaÅ‚a wywoÅ‚ana z `await`).
*   ZaproponowaÅ‚ zmiany i obsÅ‚ugÄ™ odpowiedzi w wielu plikach.

NastÄ™pnie CLI czeka na dane wejÅ›ciowe uÅ¼ytkownika w celu oceny zmian. JeÅ›li uÅ¼ytkownik siÄ™ zgodzi, zastosuje sugerowane zmiany.

#### Implementacja i testowanie poprawki
Teraz zaimplementujmy i przetestujmy poprawki sugerowane przez Gemini.

**Monit:** `Napisz test jednostkowy dla tej zmiany w pytest w pliku test_shared.py.`

Gemini CLI:
*   WstawiÅ‚ `json.dumps()` przed wysÅ‚aniem Å‚adunku zadania.
*   UtworzyÅ‚ `test_agents.py`, aby dodaÄ‡ testy jednostkowe.
*   DodaÅ‚ nowy przypadek testowy, aby sprawdziÄ‡ schemat i przekazaÄ‡ zagnieÅ¼dÅ¼one wiadomoÅ›ci agentÃ³w.

#### Generowanie dokumentacji
Teraz, gdy poprawki zostaÅ‚y zastosowane, podsumujmy zmiany i zapiszmy je w Markdown w pliku `.txt`.

**Monit:** `Napisz podsumowanie Markdown bÅ‚Ä™du, poprawki i pokrycia testÃ³w. Sformatuj je jako wpis w dzienniku zmian pod wersjÄ… "v0.2.0".`

NastÄ™pnie, aby zapisaÄ‡ podsumowanie w dokumencie, uÅ¼yÅ‚em nastÄ™pujÄ…cego monitu:

**Monit:** `Zapisz to podsumowanie w pliku .txt i nazwij je summary.txt`

Gemini CLI uÅ¼ywa narzÄ™dzia `WriteFile` do zapisania pliku `summary.txt` w katalogu projektu.

#### Generowanie schematu blokowego za pomocÄ… MCP
Ta sekcja rozszerza poprzednie eksperymenty, w ktÃ³rych badam, w jaki sposÃ³b Gemini CLI wykorzystuje **Model Context Protocol (MCP)** do utrzymywania podsumowaÅ„ na poziomie plikÃ³w i historii zadaÅ„ miÄ™dzy monitami. Daje to Gemini "pamiÄ™Ä‡ roboczÄ…" w ramach sesji.

**Monit:** `Wygeneruj schemat blokowy, ktÃ³ry pokazuje, jak agenci komunikujÄ… siÄ™ za poÅ›rednictwem A2A (agent-to-agent) i jak main.py zarzÄ…dza systemem. PodkreÅ›l, gdzie wystÄ…piÅ‚ problem i jak zostaÅ‚ naprawiony.`

Ta wizualizacja byÅ‚a moÅ¼liwa dziÄ™ki trwaÅ‚ej pamiÄ™ci Gemini, ktÃ³ra zachowaÅ‚a peÅ‚ny kontekst naszej poprzedniej poprawki bÅ‚Ä™du i struktury agenta bez koniecznoÅ›ci ponownego Å‚adowania plikÃ³w.

### DostÄ™pne narzÄ™dzia Gemini CLI
WywoÅ‚anie polecenia `/tools` w Gemini CLI wyÅ›wietli listÄ™ dostÄ™pnych narzÄ™dzi, ktÃ³re moÅ¼na wykorzystaÄ‡ do wykonywania rÃ³Å¼nych zadaÅ„, takich jak edycja kodu, generowanie testÃ³w, tworzenie dokumentacji i wiele innych.
![Tools](assets/gemini_cli_1/tools.png)

**ReadFolder (ls)**
WyÅ›wietla listÄ™ plikÃ³w i folderÃ³w w katalogu â€” podobnie jak polecenie `ls` w wierszu poleceÅ„.

**ReadFile (read-file)**
Odczytuje peÅ‚nÄ… zawartoÅ›Ä‡ pojedynczego pliku, przydatne do tworzenia podsumowaÅ„ lub analizy.

**ReadManyFiles (read-many-files)**
Odczytuje wiele plikÃ³w jednoczeÅ›nie, zazwyczaj wedÅ‚ug wzorca (np. wszystkie pliki `.js`).

**FindFiles (glob)**
Wyszukuje pliki wedÅ‚ug wzorca (np. znajdÅº wszystkie pliki `config.json` w swoim projekcie).

**SearchText (grep)**
Wyszukuje tekst w plikach, na przykÅ‚ad, aby znaleÅºÄ‡ wszystkie komentarze `TODO`.

**Edit (edit)**
Stosuje zmiany w kodzie za pomocÄ… `diff`. Gemini wyÅ›wietla podglÄ…d edycji i prosi o potwierdzenie przed ich zastosowaniem.

**WriteFile (write-file)**
Tworzy nowe pliki (np. `README.md`) z treÅ›ciÄ… dostarczonÄ… przez uÅ¼ytkownika.

**Shell (shell)**
Wykonuje polecenia bezpoÅ›rednio w terminalu, jeÅ›li poprzedzisz je prefiksem `!` (np. `!npm test`).

**WebFetch (web-fetch)**
Pobiera zawartoÅ›Ä‡ z sieci (HTML lub JSON), umoÅ¼liwiajÄ…c Gemini analizowanie danych zewnÄ™trznych.

**GoogleSearch (web-search)**
Wykonuje wyszukiwanie w Google, aby oprzeÄ‡ odpowiedzi na rzeczywistych informacjach (np. aby znaleÅºÄ‡ wyjaÅ›nienie bÅ‚Ä™du).

**Save Memory (memoryTool)**
Zapisuje fakty lub preferencje podczas sesji (np. "WolÄ™ async/await"), aby poprawiÄ‡ spÃ³jnoÅ›Ä‡ i koherencjÄ™ odpowiedzi.

### Zaawansowane funkcje

MoÅ¼esz dodawaÄ‡ specjalne instrukcje dla AI dla konkretnego projektu,
TworzÄ…c plik `GEMINI.md` w katalogu gÅ‚Ã³wnym swojego projektu.
WewnÄ…trz tego pliku moÅ¼esz zdefiniowaÄ‡ zasady projektu,
style kodu i narzÄ™dzia, ktÃ³rych agent powinien uÅ¼ywaÄ‡. Zapewnia to, Å¼e wygenerowany kod jest zgodny ze standardami Twojego projektu.

[PrzykÅ‚ad instrukcji systemowej](https://github.com/hypo69/hypotez/blob/master/src/endpoints/hypo69/code_assistant/instructions/CODE_RULES.EN.MD)

### Integracja Google CLI z MCP

W przypadku wiÄ™kszoÅ›ci codziennych zadaÅ„ wbudowane narzÄ™dzia bÄ™dÄ… wystarczajÄ…ce. Ale co, jeÅ›li chcesz, aby Gemini CLI robiÅ‚o coÅ› wysoce wyspecjalizowanego, na przykÅ‚ad wchodziÅ‚o w interakcje z okreÅ›lonymi interfejsami API lub uÅ¼ywaÅ‚o wyspecjalizowanego modelu (powiedzmy, generatora obrazÃ³w lub narzÄ™dzia do analizy bezpieczeÅ„stwa)? WÅ‚aÅ›nie tutaj wkracza MCP (Model Context Protocol).

Zasadniczo MCP to otwarty standard, ktÃ³ry pozwala programistom dodawaÄ‡ nowe narzÄ™dzia i moÅ¼liwoÅ›ci do AI poprzez uruchomienie serwera, z ktÃ³rym CLI moÅ¼e siÄ™ komunikowaÄ‡. W Gemini CLI moÅ¼esz skonfigurowaÄ‡ "serwery MCP" w pliku ustawieÅ„ JSON, a CLI bÄ™dzie traktowaÄ‡ je jako dodatkowe narzÄ™dzia, ktÃ³rych moÅ¼e uÅ¼ywaÄ‡.

#### Jak skonfigurowaÄ‡ serwer MCP w Google CLI

Jako przykÅ‚ad pokaÅ¼Ä™, jak skonfigurowaÄ‡ serwer MCP dla GitHuba w Gemini CLI.

W folderze projektu utwÃ³rz folder za pomocÄ… polecenia:

```bash
mkdir -p .gemini && touch .gemini/settings.json
```
WypeÅ‚nij plik tym kodem:
```json
{
  "mcpServers": {
    "github": {
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-github"],
      "env": { "GITHUB_PERSONAL_ACCESS_TOKEN": "[YOUR-TOKEN]" }
    }
  }
}
```
[instrukcje, jak uzyskaÄ‡ token](https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens#creating-a-personal-access-token-classic)
NastÄ™pnie wpisz `/quit` w Gemini CLI, aby wyjÅ›Ä‡, a nastÄ™pnie otwÃ³rz go ponownie.
Zobaczysz, Å¼e serwer MCP GitHuba dziaÅ‚a i jest gotowy do uÅ¼ycia.
![MCP](assets/gemini_cli_1/mcp.png)
Wpisz polecenie `/mcp`, a zobaczysz listÄ™ narzÄ™dzi GitHuba.
![Mcp Commands](assets/gemini_cli_1/mcp_commands.png)
