## Gemini CLI: Wprowadzenie i pierwsze kroki.

**Gemini CLI** to narzÄ™dzie, ktÃ³re dziaÅ‚a bezpoÅ›rednio w Twoim terminalu, rozumie TwojÄ… bazÄ™ kodu i pomaga naprawiaÄ‡ bÅ‚Ä™dy za pomocÄ… zapytaÅ„ w jÄ™zyku naturalnym. Jest to odpowiedÅº Google na Claude Code od Anthropic.
MoÅ¼esz uÅ¼ywaÄ‡ Gemini 2.5 Pro (po osiÄ…gniÄ™ciu limitu narzÄ™dzie przeÅ‚Ä…czy siÄ™ na Gemini 2.5 Flash) i jego okna kontekstowego o pojemnoÅ›ci 1 miliona tokenÃ³w, aby wykonywaÄ‡ do 60 zapytaÅ„ na minutÄ™ i 1000 zapytaÅ„ dziennie, a wszystko to za darmo.

### Spis treÅ›ci
*   Zrozumienie i nawigacja po duÅ¼ych bazach kodu
*   Wykrywanie i naprawianie bÅ‚Ä™dÃ³w
*   Pisanie i testowanie kodu
*   NarzÄ™dzia Gemini CLI
*   Integracja Google CLI z MCP

### Kluczowe moÅ¼liwoÅ›ci Gemini CLI:
*   **Edycja i refaktoryzacja:** Automatycznie ulepsza i upraszcza TwÃ³j kod pod kierunkiem AI.
*   **Wykrywanie i naprawianie bÅ‚Ä™dÃ³w:** Znajduje bÅ‚Ä™dy i proponuje poprawki.
*   **Zrozumienie kodu:** Gemini CLI moÅ¼e podsumowaÄ‡ architekturÄ™, wyjaÅ›niÄ‡ role moduÅ‚Ã³w lub zbudowaÄ‡ mapy przepÅ‚ywu wykonania.
*   **Generowanie testÃ³w:** Automatycznie tworzy zadania testowe dla `pytest`.
*   **Wsparcie dokumentacji:** MoÅ¼esz tworzyÄ‡ ustrukturyzowane dokumenty Markdown, listy zmian (changelogi) i odpowiedzi na problemy GitHub bezpoÅ›rednio w terminalu.
*   **Wykonywanie poleceÅ„:** Gemini CLI moÅ¼e wykonywaÄ‡ polecenia powÅ‚oki, takie jak `git`, `npm`, `pip` i inne, co pozwala zarzÄ…dzaÄ‡ projektami bez wychodzenia z CLI.

---

### Krok 1: Wymagania wstÄ™pne

Na poczÄ…tek zainstaluj Node.js (wersja 18 lub wyÅ¼sza). MoÅ¼esz pobraÄ‡ instalator wedÅ‚ug wÅ‚asnego wyboru lub wykonaÄ‡ nastÄ™pujÄ…ce polecenia bash w swoim terminalu:

```bash
# Pobieranie i instalacja nvm (Node Version Manager):
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.3/install.sh | bash

# Inicjalizacja nvm w bieÅ¼Ä…cej sesji terminala
. "$HOME/.nvm/nvm.sh"

# Pobieranie i instalacja Node.js (np. wersji 22):
nvm install 22

# Sprawdzenie wersji Node.js:
node -v # Powinno wyÅ›wietliÄ‡ "v22.17.0" lub podobne

# Sprawdzenie wersji npm:
npm -v # Powinno wyÅ›wietliÄ‡ "10.9.2" lub podobne
```

> âš ï¸ **WaÅ¼ne dla uÅ¼ytkownikÃ³w Windows:**
> PowyÅ¼sze polecenie `nvm` jest przeznaczone dla **Linux/macOS** i **nie bÄ™dzie dziaÅ‚aÄ‡ w PowerShell ani cmd.exe**.
> Dla Windows uÅ¼yj [nvm-windows](https://github.com/coreybutler/nvm-windows), pobierajÄ…c `nvm-setup.exe` z sekcji [Releases](https://github.com/coreybutler/nvm-windows/releases).
> Alternatywnie moÅ¼esz zainstalowaÄ‡ WSL (Windows Subsystem for Linux) i wykonaÄ‡ polecenia w Ubuntu lub innej dystrybucji Linuksa.

---
### Krok 2: Konfiguracja Gemini CLI

#### Krok 2.1: Instalacja Gemini CLI
Gdy Node.js i npm sÄ… zainstalowane i sprawdzone, zainstaluj Gemini CLI, wykonujÄ…c nastÄ™pujÄ…ce polecenie w swoim terminalu:
```bash
npx https://github.com/google-gemini/gemini-cli
```
Lub uÅ¼yj `npm` do globalnej instalacji:
```bash
npm install -g @google/gemini-cli
gemini
```
Po instalacji wpisz `gemini` w terminalu, aby uzyskaÄ‡ dostÄ™p do narzÄ™dzia.

#### Krok 2.2: Uwierzytelnianie
MoÅ¼esz uÅ¼yÄ‡ swojego osobistego konta Google do uwierzytelnienia. Zapewni to do 60 zapytaÅ„ na minutÄ™ i 1000 zapytaÅ„ dziennie podczas korzystania z Gemini.
![First Run](assets/gemini_cli_1/auth.png)

W tym przewodniku uÅ¼yÅ‚em **Logowania przez Google**, ale moÅ¼esz rÃ³wnieÅ¼ uÅ¼yÄ‡ **klucza API** (ustawionego jako zmienna Å›rodowiskowa lub w pliku `.env`) lub uwierzytelniania przez **Vertex AI**.

Aby wygenerowaÄ‡ nowy klucz API, zaloguj siÄ™ do **AI Studio** za pomocÄ… swojego konta Google i kliknij "UtwÃ³rz klucz API".
```bash
# Ustawienie klucza jako zmiennej Å›rodowiskowej
export GEMINI_API_KEY="TwÃ³j_Klucz_API"

# Lub utwÃ³rz plik .env
GEMINI_API_KEY="TwÃ³j_Klucz_API"
```
MoÅ¼esz uÅ¼yÄ‡ polecenia `/auth` w polu tekstowym, aby w razie potrzeby przeÅ‚Ä…czyÄ‡ metodÄ™ uwierzytelniania.

---

### Krok 3: Konfiguracja projektu w Gemini CLI
![Start](assets/gemini_cli_1/start.png)
Gdy CLI jest uruchomione, moÅ¼emy rozpoczÄ…Ä‡ interakcjÄ™ z Gemini z terminala. IstniejÄ… dwa sposoby pracy z projektem.

#### 1. RozpoczÄ™cie nowego projektu
Aby rozpoczÄ…Ä‡ projekt od zera, wykonaj nastÄ™pujÄ…ce polecenia:
```bash
cd new-project/
gemini
```
WewnÄ…trz CLI uÅ¼yj promptu, aby rozwiÄ…zaÄ‡ interesujÄ…cy CiÄ™ problem, na przykÅ‚ad:
> Napisz kod enkodera dla transformera od podstaw.
![Example 1](assets/gemini_cli_1/example_1.png)
Udziel pozwolenia na zapis plikÃ³w:
![File](assets/gemini_cli/file.png)

#### 2. Praca z istniejÄ…cym projektem
JeÅ›li masz juÅ¼ bazÄ™ kodu, moÅ¼esz z niÄ… pracowaÄ‡, wykonujÄ…c nastÄ™pujÄ…ce polecenia:
```bash
git clone https://github.com/AashiDutt/Google-Agent-Development-Kit-Demo
cd Google-Agent-Development-Kit-Demo
gemini
```
WewnÄ…trz CLI uÅ¼yj promptu, na przykÅ‚ad:
> Przedstaw mi podsumowanie wszystkich zmian wprowadzonych w bazie kodu w ciÄ…gu ostatniego miesiÄ…ca.

---

### Krok 4: Eksperymenty z Gemini CLI
Jako przykÅ‚ad uÅ¼yjÄ™ projektu **[Planer podrÃ³Å¼y ğŸŒğŸ›« oparty na ADK](https://github.com/AashiDutt/Google-Agent-Development-Kit-Demo)**.
Za pomocÄ… Gemini CLI pokaÅ¼Ä™, jak:
1.  badaÄ‡ bazÄ™ kodu
2.  wykryÄ‡ bÅ‚Ä…d lub problem na GitHubie lub w pliku
3.  przeprowadziÄ‡ refaktoryzacjÄ™ kodu i wygenerowaÄ‡ testy jednostkowe
4.  utworzyÄ‡ raport Markdown o wprowadzonych zmianach
5.  wizualizowaÄ‡ bazÄ™ kodu, generujÄ…c schemat blokowy

#### Badanie i zrozumienie bazy kodu
Zacznijmy od poproszenia Gemini o zbadanie i wyjaÅ›nienie bazy kodu.

**Prompt:** `Zbadaj bieÅ¼Ä…cy katalog i opisz architekturÄ™ projektu.`

Gemini CLI zwrÃ³ci ustrukturyzowane podsumowanie wyjaÅ›niajÄ…ce architekturÄ™:
*   **Interfejs uÅ¼ytkownika:** Aplikacja Streamlit (`travel_ui.py`) zapewnia interfejs do interakcji.
*   **Orkiestracja:** `host_agent` dziaÅ‚a jako centralny koordynator.
*   **Wyspecjalizowani agenci:** `flight_agent`, `stay_agent`, `activities_agent` do wyszukiwania lotÃ³w, hoteli i rozrywek.
*   **Komunikacja:** Agenci komunikujÄ… siÄ™ ze sobÄ… za poÅ›rednictwem RESTful API w FastAPI.
*   **WspÃ³lne komponenty:** `shared/schemas.py` definiuje wspÃ³lne struktury danych.

PomoÅ¼e to zorientowaÄ‡ siÄ™ bez rÄ™cznego czytania kaÅ¼dego pliku.

#### Analiza i naprawa problemu na GitHubie
Zbadajmy niektÃ³re otwarte problemy z repozytorium GitHub.

**Prompt:** `Oto problem na GitHubie: [@search https://github.com/AashiDutt/Google-Agent-Development-Kit-Demo/issues/1]. Przeanalizuj bazÄ™ kodu i zaproponuj 3-etapowy plan naprawy. Jakie pliki/funkcje naleÅ¼y zmieniÄ‡?`

Gemini CLI zbadaÅ‚ problem:
*   UÅ¼ywajÄ…c funkcji `@search`, pobraÅ‚ dane z GitHuba.
*   ZidentyfikowaÅ‚ gÅ‚Ã³wnÄ… przyczynÄ™ jako bÅ‚Ä…d serializacji JSON (w tym przypadku asynchroniczna funkcja `create_session()` nie zostaÅ‚a wywoÅ‚ana z `await`).
*   ZaproponowaÅ‚ zmiany i obsÅ‚ugÄ™ odpowiedzi w kilku plikach.

NastÄ™pnie CLI oczekuje na dane wejÅ›ciowe od uÅ¼ytkownika w celu oceny zmian. JeÅ›li uÅ¼ytkownik siÄ™ zgodzi, wprowadzi proponowane zmiany.

#### WdroÅ¼enie i testowanie poprawki
Teraz wdroÅ¼ymy i przetestujemy poprawki zaproponowane przez Gemini.

**Prompt:** `Napisz test jednostkowy dla tej zmiany w pytest w pliku test_shared.py.`

Gemini CLI:
*   WstawiÅ‚ `json.dumps()` przed wysÅ‚aniem Å‚adunku zadania.
*   UtworzyÅ‚ `test_agents.py` w celu dodania testÃ³w jednostkowych.
*   DodaÅ‚ nowy przypadek testowy do sprawdzania schematu i przekazywania zagnieÅ¼dÅ¼onych wiadomoÅ›ci agentÃ³w.

#### Generowanie dokumentacji
Teraz, gdy poprawki zostaÅ‚y wprowadzone, podsumujmy zmiany i zapiszmy je w Markdown w pliku `.txt`.

**Prompt:** `Napisz podsumowanie Markdown dotyczÄ…ce bÅ‚Ä™du, poprawki i pokrycia testowego. Sformatuj to jako wpis w dzienniku zmian pod wersjÄ… "v0.2.0".`

NastÄ™pnie, aby zapisaÄ‡ podsumowanie w dokumencie, uÅ¼yÅ‚em nastÄ™pujÄ…cego promptu:

**Prompt:** `Zapisz to podsumowanie w pliku .txt i nazwij go summary.txt`

Gemini CLI uÅ¼ywa narzÄ™dzia `WriteFile` do zapisania pliku `summary.txt` w katalogu projektu.

#### Generowanie schematu blokowego za pomocÄ… MCP
Ta sekcja rozszerza poprzednie eksperymenty, w ktÃ³rych badam, jak Gemini CLI uÅ¼ywa **Model Context Protocol (MCP)** do utrzymywania podsumowaÅ„ na poziomie plikÃ³w i historii zadaÅ„ miÄ™dzy promptami. Daje to Gemini "pamiÄ™Ä‡ roboczÄ…" w ramach sesji.

**Prompt:** `Wygeneruj schemat blokowy, ktÃ³ry pokazuje, jak agenci komunikujÄ… siÄ™ za poÅ›rednictwem A2A (agent-to-agent) i jak main.py zarzÄ…dza systemem. PodkreÅ›l, gdzie wystÄ…piÅ‚ problem i jak zostaÅ‚ naprawiony.`

Ta wizualizacja staÅ‚a siÄ™ moÅ¼liwa dziÄ™ki staÅ‚ej pamiÄ™ci Gemini, ktÃ³ra zachowaÅ‚a peÅ‚ny kontekst naszej poprzedniej poprawki bÅ‚Ä™du i struktury agenta bez koniecznoÅ›ci ponownego Å‚adowania plikÃ³w.

### DostÄ™pne narzÄ™dzia Gemini CLI
WywoÅ‚anie polecenia `/tools` w Gemini CLI pokaÅ¼e listÄ™ dostÄ™pnych narzÄ™dzi, ktÃ³re moÅ¼na wykorzystaÄ‡ do wykonywania rÃ³Å¼nych zadaÅ„, takich jak edycja kodu, generowanie testÃ³w, tworzenie dokumentacji i wiele innych.
![Tools](assets/gemini_cli_1/tools.png)

**ReadFolder (ls)**
WyÅ›wietla pliki i foldery w katalogu â€” analogicznie do polecenia `ls` w wierszu poleceÅ„.

**ReadFile (read-file)**
Odczytuje peÅ‚nÄ… zawartoÅ›Ä‡ jednego pliku, co jest przydatne do tworzenia podsumowaÅ„ lub analizy.

**ReadManyFiles (read-many-files)**
Odczytuje wiele plikÃ³w jednoczeÅ›nie, zazwyczaj wedÅ‚ug wzorca (np. wszystkie pliki `.js`).

**FindFiles (glob)**
Wyszukuje pliki wedÅ‚ug wzorca (np. znajdÅº wszystkie pliki `config.json` w swoim projekcie).

**SearchText (grep)**
Wyszukuje tekst w plikach, np. w celu znalezienia wszystkich komentarzy `TODO`.

**Edit (edit)**
Stosuje zmiany w kodzie za pomocÄ… `diff`. Gemini pokazuje podglÄ…d poprawek i prosi o potwierdzenie przed ich zastosowaniem.

**WriteFile (write-file)**
Tworzy nowe pliki (np. `README.md`) z treÅ›ciÄ… dostarczonÄ… przez uÅ¼ytkownika.

**Shell (shell)**
Wykonuje polecenia bezpoÅ›rednio w terminalu, jeÅ›li dodasz przed nimi prefiks `!` (np. `!npm test`).

**WebFetch (web-fetch)**
Pobiera zawartoÅ›Ä‡ z sieci (HTML lub JSON), umoÅ¼liwiajÄ…c Gemini analizowanie danych zewnÄ™trznych.

**GoogleSearch (web-search)**
Pobiera zawartoÅ›Ä‡ z sieci (HTML lub JSON), umoÅ¼liwiajÄ…c Gemini analizowanie danych zewnÄ™trznych.

**Save Memory (memoryTool)**
Zapisuje fakty lub preferencje podczas sesji (np. â€wolÄ™ async/awaitâ€), aby poprawiÄ‡ spÃ³jnoÅ›Ä‡ i zgodnoÅ›Ä‡ odpowiedzi.

### Rozszerzone moÅ¼liwoÅ›ci

MoÅ¼esz dodawaÄ‡ specjalne instrukcje dla AI dla konkretnego projektu, tworzÄ…c plik `GEMINI.md` w katalogu gÅ‚Ã³wnym swojego projektu. WewnÄ…trz tego pliku moÅ¼esz definiowaÄ‡ reguÅ‚y projektu, style kodu i narzÄ™dzia, ktÃ³rych powinien uÅ¼ywaÄ‡ agent. Gwarantuje to, Å¼e wygenerowany kod jest zgodny ze standardami Twojego projektu.

[PrzykÅ‚ad instrukcji systemowej](https://github.com/hypo69/hypotez/blob/master/src/endpoints/hypo69/code_assistant/instructions/CODE_RULES.EN.MD)

### Integracja Google CLI z MCP

Dla wiÄ™kszoÅ›ci codziennych zadaÅ„ wystarczÄ… wbudowane narzÄ™dzia. Ale co, jeÅ›li chcesz, aby Gemini CLI robiÅ‚ coÅ› wysoce wyspecjalizowanego, na przykÅ‚ad wchodziÅ‚ w interakcje z okreÅ›lonymi API lub uÅ¼ywaÅ‚ wyspecjalizowanego modelu (powiedzmy, generatora obrazÃ³w lub narzÄ™dzia do analizy bezpieczeÅ„stwa)? WÅ‚aÅ›nie tutaj z pomocÄ… przychodzi MCP (protokÃ³Å‚ kontekstu modelu).

Zasadniczo MCP to otwarty standard, ktÃ³ry pozwala programistom dodawaÄ‡ nowe narzÄ™dzia i moÅ¼liwoÅ›ci do AI poprzez uruchomienie serwera, z ktÃ³rym CLI moÅ¼e wchodziÄ‡ w interakcje. W Gemini CLI moÅ¼esz skonfigurowaÄ‡ â€serwery MCPâ€ w pliku ustawieÅ„ JSON, a CLI bÄ™dzie traktowaÄ‡ je jako dodatkowe narzÄ™dzia, ktÃ³rych moÅ¼e uÅ¼ywaÄ‡.

#### Jak skonfigurowaÄ‡ serwer MCP w Google CLI

Jako przykÅ‚ad pokaÅ¼Ä™ Ci, jak skonfigurowaÄ‡ serwer MCP dla GitHuba w Gemini CLI.

WewnÄ…trz folderu swojego projektu utwÃ³rz folder za pomocÄ… polecenia:

```bash
mkdir -p .gemini && touch .gemini/settings.json
```

Zapisz ten kod w pliku:
```json
{  
  "mcpServers": {  
    "github": {  
      "command": "npx",  
      "args": ["-y", "@modelcontextprotocol/server-github"],  
      "env": { "GITHUB_PERSONAL_ACCESS_TOKEN": "[TWÃ“J-TOKEN]" }  
    }  
  }  
}
```
[instrukcja jak uzyskaÄ‡ token](https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens#creating-a-personal-access-token-classic)

NastÄ™pnie wpisz `/quit` w Gemini CLI, aby wyjÅ›Ä‡, a nastÄ™pnie otwÃ³rz go ponownie.

Zobaczysz, Å¼e serwer MCP GitHub jest uruchomiony i gotowy do uÅ¼ycia.
![MCP](assets/gemini_cli_1/mcp.png)

Wpisz polecenie `/mcp`, a zobaczysz listÄ™ narzÄ™dzi GitHub.
![Mcp Commands](assets/gemini_cli_1/mcp_commands.png)