## Gemini CLI: Руководство по установке и работе

**Gemini CLI** — терминальный инструмент Google, который позволяет исследовать кодовую базу, исправлять ошибки, проводить рефакторинг и автоматически генерировать тесты и документацию. Он работает с Gemini 2.5 Pro (контекст до 1 миллиона токенов) и поддерживает до 60 запросов в минуту и 1000 запросов в день. Gemini CLI умеет выполнять команды оболочки (`git`, `npm`, `pip`) прямо внутри терминала, что позволяет управлять проектами без выхода из CLI.

---

### Шаг 1: Предварительные требования — установка Node.js и npm

Для работы Gemini CLI требуется Node.js версии 18 и выше. На Linux и macOS рекомендуется использовать **Node Version Manager (nvm)**, чтобы удобно управлять версиями Node.js без конфликтов.

Сначала скачиваем и устанавливаем nvm:

```bash
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.3/install.sh | bash
```

Затем инициализируем nvm в текущей сессии терминала:

```bash
. "$HOME/.nvm/nvm.sh"
```

После этого можно установить нужную версию Node.js (например, 22):

```bash
nvm install 22
```

Проверяем установку Node.js и npm:

```bash
node -v   # должно вывести версию, например v22.17.0
npm -v    # должно вывести версию, например 10.9.2
```

На Windows nvm из Linux не работает. Здесь можно использовать [nvm-windows](https://github.com/coreybutler/nvm-windows) или WSL (Windows Subsystem for Linux). Для nvm-windows скачайте `nvm-setup.exe` и следуйте инструкциям установщика.

---

### Шаг 2: Получение ключа Gemini API

Чтобы Gemini CLI мог взаимодействовать с моделями Google, требуется API ключ. Он подтверждает, что запросы отправляются именно от вашего аккаунта.

![video](https://youtu.be/0vg0nmTyUqs)

1. Откройте [Google AI Studio](https://aistudio.google.com/) и войдите в свою учетную запись Google.
2. В левой панели найдите пункт **Get API key**.
3. Создайте новый ключ (**Create API key**). Если у вас нет проекта в Google Cloud, система предложит автоматически создать новый проект.
4. Скопируйте ключ сразу после создания, так как повторно увидеть его будет нельзя.

**Совет:** храните ключ в надежном месте, не вставляйте его в код и не публикуйте в Git. Оптимально использовать переменные окружения или менеджеры паролей.

---

### Шаг 3: Установка Gemini CLI

Gemini CLI можно установить двумя способами. Одноразовый запуск через npx:

```bash
npx https://github.com/google-gemini/gemini-cli
```

Для постоянного использования лучше глобальная установка через npm:

```bash
npm install -g @google/gemini-cli
```

После глобальной установки командой `gemini` запускается CLI.

---

### Шаг 4: Настройка переменной окружения GEMINI\_API\_KEY

Чтобы CLI использовал API ключ, нужно настроить переменную окружения.

На Linux и macOS временно:

```bash
export GEMINI_API_KEY="ваш_ключ"
```

Для постоянного использования добавьте эту строку в `~/.bashrc` или `~/.zshrc`.

На Windows через PowerShell:

```powershell
setx GEMINI_API_KEY "ваш_ключ"
```

Проверить работу ключа можно командой:

```bash
gemini whoami
```

Если ключ корректный, CLI отобразит информацию о вашем аккаунте.

---

### Шаг 5: Настройка проекта и работа с Gemini CLI

Для нового проекта создайте папку, перейдите в нее и запустите Gemini CLI:

```bash
mkdir new-project
cd new-project
gemini
```

Для работы с существующим проектом:

```bash
git clone <repo_url>
cd <repo_dir>
gemini
```

Внутри CLI команды вводятся на естественном языке. Можно просить исследовать проект, найти ошибки, предложить исправления, провести рефакторинг, сгенерировать тесты и создать markdown-отчеты о внесенных изменениях. Gemini CLI показывает предварительный просмотр изменений и применяет их только после вашего подтверждения.

---

### Шаг 6: MCP и интеграция внешних инструментов

MCP (Model Context Protocol) позволяет подключать внешние инструменты, например GitHub, и использовать их прямо из CLI.

Создайте файл `.gemini/settings.json` с настройками MCP-сервера:

```json
{
  "mcpServers": {
    "github": {
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-github"],
      "env": { "GITHUB_PERSONAL_ACCESS_TOKEN": "[YOUR-TOKEN]" }
    }
  }
}
```

После перезапуска CLI (`/quit` → снова `gemini`) MCP-сервер станет доступен как инструмент. Теперь Gemini CLI сможет выполнять запросы к GitHub или другим интегрированным сервисам.

---

### Шаг 7: Основные инструменты Gemini CLI

CLI предоставляет встроенные инструменты для работы с проектом:

* **ReadFile / ReadManyFiles / FindFiles** — читать файлы по шаблону или один файл целиком.
* **SearchText** — поиск текста в проекте, например `TODO`.
* **Edit** — редактирование кода через diff с предварительным просмотром изменений.
* **WriteFile** — создание новых файлов с содержимым, сгенерированным Gemini.
* **Shell** — выполнение команд оболочки, например `!npm test`.
* **WebFetch / GoogleSearch** — загрузка данных из веба и поиск информации через Google.
* **Save Memory** — сохранение фактов и предпочтений пользователя, чтобы поддерживать последовательность в диалогах.

---

### Шаг 8: Практика и эксперименты

На примере проекта «Планировщик путешествий на базе ADK» Gemini CLI может:

1. Проанализировать структуру проекта, показать архитектуру и роли модулей.
2. Найти ошибки и предложить пошаговое исправление.
3. Создать юнит-тесты для проверки изменений.
4. Сгенерировать Markdown-отчет о внесенных исправлениях.
5. Визуализировать работу агентов и поток данных с помощью MCP и блок-схем.

Эта последовательность помогает быстро разбираться в коде, даже если проект большой, и автоматизирует рутинные задачи, такие как исправление багов, генерация тестов и документации.

