PowerShell является мощным инструментом для работы с реестром Windows, который по сути является центральной базой данных для всех настроек системы. Мониторинг и аудит реестра — это ключ к пониманию того, как работает система, а также к обеспечению её безопасности и стабильности.

Несколько полезных вещей, которые можно проверить в реестре с помощью PowerShell.

### 1\. **Проверка программ автозагрузки (Startup)**

Мы уже немного затрагивали эту тему, но реестр является основным местом, где программы регистрируют себя для автоматического запуска. Проверка этих ключей поможет выявить нежелательное ПО или вредоносные программы.

**Сценарий:** Вы хотите узнать, какие программы запускаются автоматически для текущего пользователя.
**Команда PowerShell:**

```powershell
Get-ItemProperty "HKCU:\Software\Microsoft\Windows\CurrentVersion\Run"
```

**Что можно узнать:**

  * `HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run`: Программы, запускаемые для всех пользователей.
  * `HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run`: Программы, запускаемые для текущего пользователя.

### 2\. **Аудит истории USB-устройств**

Реестр хранит информацию о всех USB-устройствах, которые когда-либо подключались к компьютеру. Это полезно для аудита безопасности.

**Сценарий:** Вам нужно узнать, какие USB-устройства подключались к системе.
**Команда PowerShell:**

```powershell
Get-ItemProperty "HKLM:\SYSTEM\CurrentControlSet\Enum\USBSTOR\*"
```

**Что можно узнать:**

  * Эта команда выведет список всех USB-накопителей, CD-ROM-приводов и других устройств, которые были подключены к компьютеру. Вы сможете увидеть их серийные номера и другие идентификаторы.

### 3\. **Проверка настроек системы и безопасности**

Многие важные параметры системы, включая настройки безопасности, хранятся в реестре.

**Сценарий:** Вы хотите быстро проверить, включён ли UAC (User Account Control).
**Команда PowerShell:**

```powershell
(Get-ItemProperty "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System").EnableLUA
```

**Что можно узнать:**

  * `HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion`: Общая информация о системе, такая как `ProductName`, `BuildLabEx`, и `CurrentVersion`.
  * `HKLM:\SYSTEM\CurrentControlSet\Services`: Настройки всех служб Windows. Можно посмотреть, например, какие службы запущены и какой у них тип запуска.

### 4\. **Инвентаризация установленных программ**

Хотя мы уже рассматривали этот сценарий, стоит отметить, что именно реестр является источником этой информации.

**Сценарий:** Вы хотите получить список всех 64-битных программ.
**Команда PowerShell:**

```powershell
Get-ItemProperty HKLM:\Software\Microsoft\Windows\CurrentVersion\Uninstall\* | Select-Object DisplayName, DisplayVersion
```

**Что можно узнать:**

  * `HKLM:\Software\Microsoft\Windows\CurrentVersion\Uninstall`: Список 64-битных программ.
  * `HKLM:\Software\WOW6432Node\Microsoft\Windows\CurrentVersion\Uninstall`: Список 32-битных программ на 64-битной ОС.

### 5\. **Проверка сетевых настроек**

Реестр также содержит много информации о сетевых адаптерах и их конфигурациях.

**Сценарий:** Вы хотите узнать, настроены ли статические DNS-серверы для сетевого адаптера.
**Команда PowerShell:**

```powershell
Get-ItemProperty "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces\*"
```

**Что можно узнать:**

  * Эта команда покажет настройки TCP/IP для каждого сетевого интерфейса, включая IP-адреса, маски подсети и DNS-серверы.

Эти сценарии показывают, насколько универсален PowerShell для работы с реестром. С помощью командлетов вроде `Get-ItemProperty`, `Set-ItemProperty` и `Remove-ItemProperty` можно не только читать данные, но и изменять их, что даёт полный контроль над системой. **Помните:** перед изменением реестра всегда делайте резервные копии\!