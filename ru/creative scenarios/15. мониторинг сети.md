Пример скрипта PowerShell для мониторинга сети, сгенерированный с помощью Gemini CLI. Этот скрипт проверяет сетевую активность и состояние сетевого подключения.

-----

### Скрипт мониторинга сети

Этот скрипт можно использовать для проверки доступности сетевых узлов и сбора базовой статистики сетевого трафика. Он идеально подходит для быстрого выявления проблем с сетью.

**Сценарий:** Вам нужен скрипт, который будет проверять доступность нескольких ключевых серверов в вашей сети и сообщать о среднем времени отклика, а также собирать статистику сетевых интерфейсов.

**Команда, которую можно использовать в Gemini CLI:**

```powershell
gemini-cli "Напиши скрипт PowerShell для мониторинга сети. Скрипт должен проверять доступность 3-х хостов (например, google.com, bing.com, local_server) с помощью ping, сообщая о среднем времени отклика. Также, он должен выводить статистику по сетевым интерфейсам, такую как отправленные и полученные байты."
```

**Пример сгенерированного скрипта:**

```powershell
Write-Host "--- Мониторинг сети ---" -ForegroundColor Green

# 1. Проверка доступности хостов с помощью Test-Connection
$hosts = "google.com", "bing.com", "192.168.1.1" # Замените IP-адрес на свой локальный сервер

Write-Host "`nПроверка доступности хостов:`n"

foreach ($host in $hosts) {
    Write-Host "Пингуем: $host" -ForegroundColor Cyan
    $pingResult = Test-Connection -ComputerName $host -Count 4 -Quiet
    
    if ($pingResult) {
        $averageTime = (Test-Connection -ComputerName $host -Count 4 | Measure-Object -Property ResponseTime -Average).Average
        Write-Host "Узел $host доступен. Среднее время отклика: $([math]::Round($averageTime, 2)) мс." -ForegroundColor Green
    } else {
        Write-Host "Узел $host недоступен." -ForegroundColor Red
    }
}

# 2. Получение статистики по сетевым интерфейсам
Write-Host "`nСетевая статистика:`n"

$networkInterfaces = Get-NetAdapter -Physical | Where-Object { $_.Status -eq "Up" }

if ($networkInterfaces) {
    foreach ($interface in $networkInterfaces) {
        Write-Host "Интерфейс: $($interface.Name)" -ForegroundColor Yellow
        $statistics = Get-NetAdapterStatistics -Name $interface.Name

        Write-Host "  Отправлено байт: $($statistics.BytesSent)" -ForegroundColor Cyan
        Write-Host "  Получено байт: $($statistics.BytesReceived)" -ForegroundColor Cyan
    }
} else {
    Write-Host "Активные сетевые интерфейсы не найдены." -ForegroundColor Red
}

Write-Host "`n--- Мониторинг завершён ---" -ForegroundColor Green
```

### Как это работает?

  * `Test-Connection` — это аналог команды `ping` в PowerShell. Мы используем её для проверки доступности узла и получения статистики ответа.
  * `Get-NetAdapter` — получает список всех сетевых адаптеров на компьютере. Мы фильтруем их, чтобы работать только с физическими и активными (статус `Up`).
  * `Get-NetAdapterStatistics` — собирает детальную статистику по конкретному сетевому интерфейсу, такую как количество отправленных и полученных байтов.

Этот скрипт может быть основой для более сложной системы мониторинга сети. Вы можете добавить в него:

  * **Запись логов:** Сохраняйте результаты в файл с временными метками для анализа трендов.
  * **Уведомления:** Отправляйте уведомление по электронной почте или в мессенджер, если какой-то из узлов становится недоступным.
  * **Проверку портов:** Используйте `Test-NetConnection` для проверки доступности определённых портов (например, порт 80 для веб-сервера).

Gemini CLI помогает быстро создать такую основу, а затем вы можете легко доработать её под свои нужды.