Прекрасный выбор\! Мониторинг S.M.A.R.T. (Self-Monitoring, Analysis, and Reporting Technology) дисков — это одна из самых важных задач для предотвращения потери данных. S.M.A.R.T. — это встроенная в современные жёсткие диски и SSD-накопители технология, которая отслеживает различные атрибуты их работы, помогая предсказать возможный сбой.

Вот скрипт PowerShell, который можно сгенерировать с помощью Gemini CLI, для проверки S.M.A.R.T. статуса и получения ключевых показателей здоровья дисков.


### Скрипт проверки S.M.A.R.T. статуса дисков

Этот скрипт получает общую информацию о состоянии S.M.A.R.T. для всех физических дисков в системе.

**Сценарий:** Вы хотите быстро проверить, нет ли у ваших дисков проблем, которые могут привести к сбою, прежде чем они станут критическими.

**Команда, которую можно использовать в Gemini CLI:**

```powershell
gemini-cli "Напиши скрипт PowerShell, который проверяет S.M.A.R.T. статус всех физических дисков в системе. Скрипт должен вывести для каждого диска его модель, серийный номер и общий статус здоровья (OK, Caution, или Bad). Если статус не 'OK', нужно вывести предупреждающее сообщение."
```

**Пример сгенерированного скрипта:**

```powershell
Write-Host "--- Проверка S.M.A.R.T. статуса дисков ---" -ForegroundColor Green

# Получаем все физические диски в системе
$disks = Get-PhysicalDisk

if (-not $disks) {
    Write-Host "Физические диски не найдены." -ForegroundColor Red
    return
}

# Перебираем каждый диск и выводим его S.M.A.R.T. статус
foreach ($disk in $disks) {
    Write-Host "`nДиск: $($disk.FriendlyName)" -ForegroundColor Yellow
    Write-Host "  Модель: $($disk.Model)" -ForegroundColor Cyan
    Write-Host "  Серийный номер: $($disk.SerialNumber)" -ForegroundColor Cyan

    # Получаем информацию о надёжности и S.M.A.R.T.
    $reliability = $disk | Get-StorageReliabilityCounter

    # Проверка общего статуса здоровья
    if ($disk.HealthStatus -eq "OK") {
        Write-Host "  Статус здоровья: $($disk.HealthStatus)" -ForegroundColor Green
    } elseif ($disk.HealthStatus -eq "Warning" -or $disk.HealthStatus -eq "Caution") {
        Write-Host "  Статус здоровья: $($disk.HealthStatus)" -ForegroundColor Yellow
        Write-Host "  ВНИМАНИЕ: Обнаружены потенциальные проблемы с диском. Рекомендуется создать резервную копию данных." -ForegroundColor Yellow
    } else {
        Write-Host "  Статус здоровья: $($disk.HealthStatus)" -ForegroundColor Red
        Write-Host "  ОШИБКА: Диск может выйти из строя. Немедленно создайте резервную копию и замените диск!" -ForegroundColor Red
    }

    # Вывод некоторых ключевых атрибутов S.M.A.R.T.
    Write-Host "  Ключевые показатели S.M.A.R.T.:" -ForegroundColor Cyan
    Write-Host "    Температура: $($reliability.Temperature) °C" -ForegroundColor Magenta
    Write-Host "    Количество часов работы: $($reliability.PowerOnHours) ч" -ForegroundColor Magenta
    Write-Host "    Ошибки чтения: $($reliability.ReadErrorsCorrected)" -ForegroundColor Magenta
    Write-Host "    Ошибки записи: $($reliability.WriteErrorsCorrected)" -ForegroundColor Magenta
}

Write-Host "`n--- Проверка S.M.A.R.T. завершена ---" -ForegroundColor Green
```

### Как это работает?

  * **`Get-PhysicalDisk`**: Это основной командлет, который предоставляет информацию о всех физических накопителях, подключённых к системе.
  * **`Get-StorageReliabilityCounter`**: Этот командлет расширяет функциональность, предоставляя детальные счётчики надёжности, которые напрямую связаны с S.M.A.R.T. атрибутами. Он даёт доступ к таким показателям, как **температура**, **количество часов работы** и **счётчики ошибок**.
  * **`HealthStatus`**: Это свойство является одной из самых важных частей скрипта. Оно предоставляет общую оценку состояния диска на основе S.M.A.R.T. данных. Значения могут быть "OK", "Warning" или "Bad".

Этот скрипт является отличной отправной точкой. Для ещё более глубокого анализа можно добавить вывод других S.M.A.R.T. атрибутов, таких как **Reallocated Sectors Count** (переназначенные сектора) или **Current Pending Sector Count** (текущие ожидающие сектора), которые являются одними из самых важных индикаторов надвигающегося сбоя.