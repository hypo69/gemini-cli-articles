## Руководство по Конфигурации Google Gemini CLI

Это руководство описывает основные файлы и методы конфигурации Google Gemini CLI. Правильная настройка позволяет адаптировать инструмент под личные предпочтения и требования конкретных проектов, повысить качество ответов модели и автоматизировать рутинные задачи. Примеры предоставляются для сред Linux/macOS (Bash/Zsh) и Windows (PowerShell).

---

### Часть 1: Аутентификация

Для работы Gemini CLI требуется API-ключ. Есть два основных способа его настроить.

#### Метод 1: Переменная окружения (Рекомендуемый)

Этот метод делает ваш ключ доступным во всех сеансах терминала, не сохраняя его в файлах проекта.

1.  **Получите ключ:** Сгенерируйте API-ключ в [Google AI Studio](https://aistudio.google.com/).
2.  **Добавьте в профиль оболочки:**

    *   **Для Linux/macOS (Bash/Zsh)**
        Откройте ваш конфигурационный файл (`~/.bashrc` для Bash или `~/.zshrc` для Zsh) и добавьте строку:
        ```bash
        export GEMINI_API_KEY="ВАШ_ДЛИННЫЙ_API_КЛЮЧ"
        ```
        Примените изменения, выполнив `source ~/.bashrc` (или `source ~/.zshrc`) или просто перезапустив терминал.

    *   **Для Windows (PowerShell)**
        Чтобы сделать переменную постоянной, ее нужно добавить в ваш профиль PowerShell.
        1.  Откройте профиль командой `code $PROFILE` (для VS Code) или `notepad $PROFILE`. Если файла нет, создайте его: `New-Item -Path $PROFILE -Type File -Force`.
        2.  Добавьте в файл следующую строку:
            ```powershell
            $env:GEMINI_API_KEY="ВАШ_ДЛИННЫЙ_API_КЛЮЧ"
            ```
        3.  Примените изменения, выполнив `. $PROFILE` или перезапустив терминал PowerShell.

#### Метод 2: Файл `.env` (Кроссплатформенный)

Этот способ удобен для быстрой настройки. Пути работают одинаково в обеих ОС.

*   **Глобально:** Создайте файл `~/.gemini/.env` и напишите в нем:
    ```
    GEMINI_API_KEY="ВАШ_ДЛИННЫЙ_API_КЛЮЧ"
    ```
*   **Локально для проекта:** Создайте файл `./.gemini/.env` в корне проекта. **Внимание:** Добавьте `./.gemini/` в ваш `.gitignore`, чтобы не отправить ключ в репозиторий.

---

### Часть 2: Файл Настроек `settings.json` (Кроссплатформенный)

Файл `settings.json` управляет поведением CLI. Иерархия и формат файла одинаковы для всех ОС.

**Иерархия применения:**
1.  **Проект:** `./.gemini/settings.json`
2.  **Пользователь:** `~/.gemini/settings.json`
3.  **Система:** (Расположение зависит от ОС, но пользовательские настройки имеют приоритет)

**Пример `settings.json`:**
```json
{
  "theme": "GitHub",
  "sandbox": "docker",
  "vimMode": true,
  "checkpointing": { "enabled": true },
  "fileFiltering": { "respectGitIgnore": true },
  "usageStatisticsEnabled": false,
  "includeDirectories": [
    "~/projects/shared-libs"
  ]
}```
*   `"sandbox"`: **Важно для безопасности.** Установите в `"docker"` или `"podman"`, чтобы команды выполнялись в изолированной среде.
*   `"checkpointing"`: Позволяет откатывать изменения файлов командой `/restore`.
*   `"fileFiltering"`: Указывает CLI учитывать правила из `.gitignore`.

---

### Часть 3: Контекстные Файлы `GEMINI.md` (Кроссплатформенный)

Файлы `GEMINI.md` предоставляют модели постоянные инструкции. Механизм их работы не зависит от операционной системы.

1.  **Глобальный контекст (`~/.gemini/GEMINI.md`):** Ваши личные предпочтения и стек.
2.  **Контекст проекта (`<project>/.gemini/GEMINI.md`):** Правила для всей команды.
3.  **Контекст компонента (`<project>/service-a/.gemini/GEMINI.md`):** Узкоспециализированные инструкции.

**Команды:**
*   `/init`: Создает стартовый `GEMINI.md`.
*   `/memory show`: Показывает итоговый контекст.

---

### Часть 4: Файл `.geminiignore` (Кроссплатформенный)

Аналогично `.gitignore`, этот файл указывает Gemini, какие файлы и папки игнорировать. Формат файла универсален.

**Пример `.geminiignore`:**
```
# Игнорировать скомпилированные файлы и зависимости
/node_modules/
*.log
.env
```

---

### Часть 5: Автоматизация с помощью псевдонимов и функций

Интегрируйте Gemini в ваш рабочий процесс с помощью кастомных команд оболочки.

#### Для пользователей Linux/macOS (Bash/Zsh)

Добавьте эти псевдонимы (aliases) в ваш файл `~/.bashrc` или `~/.zshrc`:
```bash
# Псевдоним для написания коммит-сообщения на основе изменений
alias gcommit='git diff --staged | gemini -p "Напиши краткое коммит-сообщение в формате Conventional Commits для этих изменений."'

# Псевдоним для рефакторинга кода из буфера обмена
# (требуется xclip на Linux, на macOS используются pbpaste/pbcopy)
alias grefactor='xclip -o | gemini -p "Сделай рефакторинг этого кода. Улучши читаемость и производительность." | xclip -i -selection clipboard'
```

#### Для пользователей Windows (PowerShell)

В PowerShell рекомендуется использовать функции. Добавьте их в ваш файл `$PROFILE`:
```powershell
# Функция для написания коммит-сообщения
function gcommit {
    git diff --staged | gemini -p "Напиши краткое коммит-сообщение в формате Conventional Commits для этих изменений."
}

# Функция для рефакторинга кода из буфера обмена
function grefactor {
    Get-Clipboard | gemini -p "Сделай рефакторинг этого кода. Улучши читаемость и производительность." | Set-Clipboard
}
```
После сохранения файла перезапустите терминал или примените изменения (`source ~/.bashrc` для Linux, `. $PROFILE` для Windows).

---

### Заключение

Правильная конфигурация Gemini CLI — ключ к его эффективному использованию. Начните с настройки переменных окружения и создания пользовательских файлов `settings.json` и `GEMINI.md`. Затем автоматизируйте часто выполняемые задачи с помощью псевдонимов или функций. Такой подход позволит превратить CLI в мощный инструмент, адаптированный под ваш личный рабочий процесс, независимо от операционной системы.